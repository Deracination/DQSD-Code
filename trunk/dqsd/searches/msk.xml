<search function="msk">
  <name>Microsoft Knowledge Base</name>
  <description>
    Search the Microsoft Knowledge Base using either a regular search expression or a 6-digit "Q" code.<br/>
    <div class="helpboxDescLabels">Examples:</div>
    <table class="helpboxDescTable">
  		<tr><td>msk Windows Bugs</td></tr>
  		<tr><td>msk q252795</td></tr>
  	</table>
  </description>
  <category>Computers</category>
  <link>http://support.microsoft.com/default.aspx?scid=fh;en-us;kbinfo</link>
  <contributor>Ryan Edwards</contributor>
  
  <script><![CDATA[
    function msk(q)
    {
      var res;
      if( nullArgs("msk",q) )
        return false;
      else if( (res = q.match(/^\s*[qQ]?(\d{6})\s*$/ )) != null )
			  openSearchWindow('http://support.microsoft.com/default.aspx?scid=kb;en-us;'+ "Q" + res[1]);
		  else
openSearchWindow('http://search.support.microsoft.com/search/default.aspx?Catalog=LCID%3D1033%26CDID%3DEN-US-KB%26PRODLISTSRC%3DON&Product=msall&Query=' + q.replace( /\s+/g,'%2520' ) + '&Queryc=' + q.replace( /\s+/g,'+' ) + '&withinResults=false&srchstep=0&KeywordType=ALL&Titles=false&numDays=&maxResults=25');
    }
  ]]></script>
</search>
