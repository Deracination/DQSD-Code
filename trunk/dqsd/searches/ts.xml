<search function="ts">
  <name>Terminal Services</name>
  <category>Computers<category>Networking</category></category>
  <contributor>Shawn K. Hall</contributor>
  <link>http://www.ReliableAnswers.com/x/dqsd/</link>
  <email>Shawn[@]ReliableAnswers.com</email>
  <description>
    Load Terminal Services to a specific domain or site. 
    Set a variable for "strTsServer" to be the first three sections 
    of the IP range you manage and you can use short-hand notation 
    including only the number of the server you wish to connect to 
    (9, 18, 252). Otherwise, entering a domain, a full IP or 
    anything with a dot or a non-numeric value is interpreted as a 
    literal domain to access. <br />
    Set the resolution with "strTsResolution".<br />
    Use "strTsUrl" to setup a different post URL for Terminal 
    Services Web access. Be sure to include the complete URL.<br />

    <div class="helpboxDescLabels">Variables:</div>
    <table class="helpboxDescTable">
      <tr><td><b>variable</b></td><td><b>default</b></td><td><b>description</b></td></tr>
      <tr><td>strTsServer</td><td>None</td><td>Default IP Range to connect to ("192.168.0.")</td></tr>
      <tr><td>strTsResolution</td><td>2</td><td>Default Resolution</td></tr>
      <tr><td> </td><td>1</td><td>FullScreen</td></tr>
      <tr><td> </td><td>2</td><td>640 x 480</td></tr>
      <tr><td> </td><td>3</td><td>800 x 600</td></tr>
      <tr><td> </td><td>4</td><td>1024 x 768</td></tr>
      <tr><td> </td><td>5</td><td>1280 x 1024</td></tr>
      <tr><td> </td><td>6</td><td>1600 x 1200</td></tr>
      <tr><td>strTsUrl</td><td>/TSWeb/</td><td>TS Web Root</td></tr>
    </table>

    <div class="helpboxDescLabels">Switches:</div>
    <table class="helpboxDescTable">
      <tr><td>server</td><td> - </td><td>server to connect to</td></tr>
    </table>

    <div class="helpboxDescLabels">Examples:</div>
    <table class="helpboxDescTable">
      <tr><td>ts 9</td></tr>
      <tr><td>ts 127.0.0.1</td></tr>
      <tr><td>ts example.com</td></tr>
    </table>
  </description>
  <comment>
    This is pretty spiffy, eh?
  </comment>

  <form name="tsf"
        method="get"
        action="http://localhost/TSWeb/">
    <input type="hidden" name="FS" value="2" />
    <input type="hidden" name="Server" value="" />
    <input type="hidden" name="AutoConnect" value="0" />
  </form>

  <script><![CDATA[
    function ts(q)
    {
      if( nullArgs( "ts", q ) ) return false;

      document.tsf.Server.value = "";

      if (typeof strTsServer == "undefined") {
      // server variable doesn't exist
      // treat query as explicit domain name
         document.tsf.Server.value    = q;
      } else {
        if (q == "") {
          if (strTsServer.lastIndexOf(".") == strTsServer.length-1) {
          // last character is a ".", 'query prefix only' flag
          // do not use a default server, ask in the prompt
             document.tsf.Server.value = "";
          } else {
          // strTsServer is 'default only', it applies
             document.tsf.Server.value = strTsServer;
          }
        } else {
          if (strTsServer.lastIndexOf(".") == strTsServer.length-1) {
          // last character is a ".", 'query prefix only' flag
            if (q.length <= 3){
            // add q
               document.tsf.Server.value = strTsServer + q;
            } else {
            // use just the query - it's too long to be 0-255
               document.tsf.Server.value = q;
            }
          } else {
          // strTsServer is 'default only', it doesn't apply
          // treat query as explicit domain name
             document.tsf.Server.value = q;
          }
        }
      }

      if (typeof strTsResolution == "undefined") {
      // no stored resolution, use default (640x480)
        document.tsf.FS.value          = "2";
      } else {
        document.tsf.FS.value          = strTsResolution;
      }

      if (document.tsf.Server.value == "") {
        document.tsf.AutoConnect.value = "0";
      } else {
        document.tsf.AutoConnect.value = "1";
      }

      if (typeof strTsUrl == "undefined") {
      // use default action url
      } else {
        document.tsf["action"] = strTsUrl;
      }
      submitForm(tsf);
    }
  ]]></script>
  <copyright>
    The following applies if this file is included and distributed with Dave's Quick Search Deskbar:
    Copyright (c) 2002 David Bau; Distributed under the terms of the GNU Public License, Version 2 (http://www.gnu.org/copyleft/gpl.txt)
  </copyright>
  <created_by>
    This search file was created on 2003/08/08 by Shawn K. Hall
    Copyright © 2003 Shawn K. Hall; Distributed under the terms of the GNU General Public License, Version 2
  </created_by>
</search>