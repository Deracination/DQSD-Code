<html>
<!--
Dave's Quick Search Deskbar
Version 2.5.0 - December 22, 2001

Copyright (c) 2001 David Bau

Distributed under the terms of the
GNU Public License, Version 2 (http://www.gnu.org/copyleft/gpl.txt)

----

This deskbar lets you launch searches from the Windows Explorer Taskbar.
For the latest version and installation instructions, visit
<a href=http://notesbydave.com/toolbar/searchdoc.htm
  target=DavesDoc onclick=window.close()>Dave's site</a>.<ul>

* Type in your search terms and hit Enter to do a Google
  Search.

* If you're feeling lucky, go directly to Google's first
  hit using an exclamation point ("Crest toothpaste!").

* Look up phone numbers and email by using #
  or @ ("Piper Smith (Ithaca, NY)#", "Bob Jones@").

* Translate between English and other languages
  (en, zh, fr, de, it, ja, ko, pt, es)
  by saying "some words en-es".

* Convert between currencies by saying "100 usd>gbp".

* Calculate math expressions by just typing them in
  <nobr>("4*(pi-3)", <wbr>"pow(1.06,30)").</nobr>

* Use ctrl-P and ctrl-N for a history of your previous searches.

* A clock shows after a few seconds. Right-click to see a calendar.

* Edit <a href="view-source:preferences.js">preferences.js</a>
  to customize your clock, default search, or other things.

* Here are some more query codes you can use:

</ul><center><table>

	!	I'm Feeling Lucky! - Go directly to the <a target="info" href="http://www.google.com/help/features.html#lucky">top ranked Google</a> result (ifl)
	?	Yahoo Search - Search within the <a target="info" href="http://www.yahoo.com/">Yahoo</a> directory (yho)
	-	FAST Web Search - Use the frequently-rebuilt <a target="info" href="http://fast.no">FAST index</a> (fst)
-	^	AltaVista Search - <a target="info" href="http://altavista.com/">AltaVista</a> was the first fulltext web index (alt)
-	|	Excite Search - Search using <a target="info" href="http://www.excite.com/">Excite</a> (exc)
	{	Dogpile Search - Parallel search via the <a target="info" href="http://www.dogpile.com/">Dogpile</a> metasearch (dog)
-	/	Yahoo Category - Zap to a <a target="info" href="http://yahoo.com/">Yahoo</a> category like "Arts/" (yhd)
	??	Google Web Directory Search - Search the <a target="info" href="http://directory.google.com/">Google Web Directory</a> (gwd)
	???	Ask Jeeves - <a target="info" href="http://ask.com">Jeeves</a> answers questions (ask)
	
	+	Mapquest Search - Get <a target="info" href="http://mapquest.com">Mapquest</a> maps with addresses such as "1400 Constitution Ave NE, Washington DC+" (map)
	#	Switchboard Individual Search - Look up <a target="info" href="http://switchboard.com/">Switchboard</a> phone numbers and addresses like this: "Bob Jones &#40;Wichita, KS)#" (swp)
	##	Switchboard Business Search - Look up businesses on <a target="info" href="http://www.switchboard.com/bin/cgidir.dll?FUNC=STDNAME&MEM=1">Switchboard</a> like this: "Harpo &#40;King of Prussia, PA)##" (swb)
	\	Switchboard Business Category - Get <a target="info" href="http://www.switchboard.com/bin/cgidir.dll?MEM=1">Switchboard</a> business categories like this: "Barbers &#40;Pittsford, NY)\" (swc)
	@	Yahoo Email Search - Search <a target="info" href="http://email.people.yahoo.com/">Yahoo's index</a> of email addresses with a name: "Roger Weber@" (yhe)
-	@@	Bigfoot Email Search - Search <a target="info" href="http://search.bigfoot.com/">Bigfoot's index</a> of email addresses with a name: "Mark Rafn@@" (bfe)
	
	=	Calculate Math Expression - Example: "sin&#40;pi/2)+cos&#40;pi)=" (clc)
	
	.	CNN News Search - Search <a target="info" href="http://cnn.com/">CNN</a>: "Saddam." (cnn)
	*	AccuWeather Forecast - <a target="info" href="http://accuweather.com/">AccuWeather</a> by zip code: "98052*" (acw)
	$	Bloomberg Stock Quotes - <a target="info" href="http://bloomberg.com/">Bloomberg</a> quotes by symbol: "WMT S$" (stk)
	
	:	Merriam-Webster Dictionary - <a target="info" href="http://m-w.com/">M-W</a> definitions: "idempotent:" (mwd)
-	::	Dictionary.com - Another <a target="info" href="http://dictionary.com/">dictionary</a> (dic)
	;	Thesaurus.com - <a target="info" href="http://thesaurus.com/">Thesaurus</a> synonyms: "flush;" (ths)
-	;;	Merriam-Webster Thesaurus - Another <a target="info" href="http://m-w.com/">thesaurus</a> (mwt)
#	;;	U. Chicago Thesaurus - <a target="info" href="http://machaut.uchicago.edu/">Another</a> alternate thesaurus (thsc)
	[	Encyclopedia.com - <a target="info" href="http://encyclopedia.com/">Encyclopedia</a> articles: "alphabet&#91;" (enc)
	]	Xrefer - <a target="info" href="http://xrefer.com/">Xrefer</a> searches dozens of reference titles: "venice]" (xrefer)
#	'	Bartlett's Familiar Quotations - From <a target="info" href="http://www.bartleby.com/100/">Bartleby.com's</a>: "penny'" (fmq)
	
	&	Google Cache - See the <a target="info" href="http://www.google.com/help/features.html#cached">cached snapshot</a>: "cnn.com&" (che)
	&&	Internet Archive - Look <a target="info" href="http://www.archive.org/index.html">way back</a> in time: "cnet.com&&" (iaw)
	>	Google Advanced Search - Use <a target="info" href="http://www.google.com/help/refinesearch.html">Google's advanced search</a> (adv)
	
	$$	DealTime Price Comparison - <a target="info" href="http://www.dealtime.com/">Comparison shop</a>: "Harry Potter$$" (dlt)
-	$$$	PriceWatch Price Comparison - <a target="info" href="http://www.pricewatch.com/">Shop technology</a>: "256 edo$$$" (pcw)
	%	Ebay Item Search - Search <a target="info" href="http://ebay.com/">Ebay</a> by number or keyword: "1485964533%" or "legendary guitar%" (eby)
	,	Google Newsgroup Search - Search <a target="info" href="http://groups.google.com/">Google newsgroups index</a> (nsg)
-	,,	Usenet FAQ Search - Search the <a target="info" href="http://www.faqs.org/faqs/">Usenet FAQ archive</a> (faq)
	>>	CNET Downloads.com Search - Search Cnet's <a target="info" href="http://download.cnet.com/">Download.com</a> shareware archive: "deskbar>>" (cds)
	
	#*	Phone Number Speller - <a target="info" href="http://www.phonespell.org/">Phonespell.org</a> spells out phone numbers: "227-4332#*" or "bar-idea#*" (psl)
	~	Word Descrambler - <a target="info" href="http://www.concordance.com/unscrambler.htm">Unscrambler</a> makes Scrabble words and gives you the score: "ouridna~" (srb)
	
-	alm	All Music Search - Search <a target="info" href="http://www.allmusic.com/">AMG All Music Guide</a> by <nobr>artist &#40;"alm Sting /a"),<wbr> title &#40;"alm Dream of /t"),<wbr> style &#40;"alm Rock /y"),<wbr> or label &#40;alm A&M /l")</nobr> (alm)
-	cddb	CDDB Music Search - Search <a target="info" href="http://www.cddb.com/">Gracenote CDDB</a> by artist /a, title /t, or song /s, or a combination: <nobr>"cddb Madonna /at"</nobr> (cdb)
-	cdnow	CDNow Music Searc - Search <a target="info" href="http://www.cdnow.com/">CDNOW</a> by artist /a, song /s, title /t, or label /l: <nobr>"cdnow Lobster /s"</nobr> (cdn)
-	sams	Sam Spade Whois Utility - Check addresses using <a target="info" "http://www.samspade.org/">SamSpade.org</a>: "sams amazon.com" (sam)
-	php	PHP Reference - Lookup on <a target="info" href="http://www.php.net/">php.net</a>: "php fopen" (php)
-	mysql	MySQL Reference - Lookup on <a target="info" href="http://www.mysql.com/">mysql.com</a>: "mysql create table" (mys)
-	imdb	Internet Movie Database - Lookup movies on <a target="info" href="http://imdb.com/">imdb</a>: "imdb jaws" (mdb)
-	isbn	ISBN Search - <a target="info" href="http://www.pricescan.com/home_books.asp">PriceScan</a> for an ISBN: "isbn 0898713617" (isbn)
-	half	HalfPrice Search - Search <a target="info" href="http://www.half.com/">half.com</a> for products: "half chaos" (half)
-	image	Google Image Search - Search for <a target="info" href="http://images.google.com/">images</a>: "image jupiter" (image)
-	msdn	MSDN Search - Search <a target="info" href="http://http://msdn.microsoft.com/library/">MSDN</a>: "msdn ocx" (msdn)
-	msdnl	MSDN Library Search - Just the <a target="info" href="http://http://msdn.microsoft.com/library/">MSDN Library</a>: "msdnl iframe" (msdnl)

</table></center>

<p>
If you want to make additions or improvements, please do.
The deskbar is customizable and completely open-source.

<ul>
* The search bar is just an HTML page:
  <a href="view-source:search.htm">search.htm</a>.

* You can add new searches by editing
  <a href="view-source:search.xml">search.xml</a>.

* After editing the code, type "!" in the search bar to reload it.

* If you have questions or contributions, please post them to the
  <a target=dqsdd onclick=window.close() href="http://groups.yahoo.com/group/dqsdd">discussion group</a>
  and share them with the community.
</ul>

# NOTE from Dave: You can modify the codes directly in the
# comment text above, and the deskbar will use the code that
# you specify. Pay attention to where the tabs are: you need
# to leave them arranged as is.
#
# You can leave items off the menu by putting a minus sign
# at the front of the line. You can also disable codes
# completely by commenting lines out with a hashmark at
# the very beginning of a line.
#
# The format is "[-#]\t[code]\t[menu desc] - [long desc] (func)"
#
# Happy searching.

-->

<title>Search</title>

<xml id='searchxml' src='search.xml'></xml>

<script>
// configuration settings

defaultsearch="goo";           // google is the default search
defaultcal="yhocal";           // yahoo is the default calendar

clock=true;                    // set to false to remove clock
clockdelay=5000;               // clock will appear after 5 secs
clockupdate=1000;              // clock will update every 1 sec
clocklongwidth=139;            // pixels for the long form
clocklongform=" EEE d MMM yyyy h:mm A "; // long clock format string
clockshortform=" h:mm A ";     // short clock format string
clocktooltipform="EEEE, MMMM d, yyyy h:mm A"; // tooltip clock format string
clockstyle="text-align:right"; // css style overrides for the clock

txtfldstyle="";                // css style overrides for the text field
buttonstyle="";                // css style overrides for the button
menustyle="cursor:default";    // css style overrides for the menu
localsearchurl="localsearch.xml"; // local search file
helptime=8500;                 // help message shows for 8.5 secs
launchmode=2;                  // 0 = use ie; 1 = default browser; 2 = auto

language = navigator.userLanguage.substr(0,2);

calbackground="menu";
caltextcolor="menutext";
calhighbackground="highlight";
calhightext="highlighttext";
caltodaybackground="infobackground";
caltodaytext="infotext";
calgraybackground="window";
calgraytext="graytext";
calmonthstyle="font-family:Tahoma;font-size:8pt;font-weight:bold";
calnavstyle="font-family:Tahoma;font-size:8pt;font-weight:bold";
caldaystyle="font-family:Tahoma;font-size:8pt;";
caldowstyle="font-family:Tahoma;font-size:8pt;";
caltodaystyle="font-family:Tahoma;font-size:8pt;font-weight:bold";

// catch errors
function handleerror(msg, url, lineno)
{
  if (!firsterror)
  {
     firsterror = msg;
     alert("Error (line " + lineno + "):\n" + msg);
  }
  return true;
}

window.onerror=handleerror;

</script>

<style>
body
{
 margin: 0px;
 border: 0;
 padding: 0;
 background-color: threedface;
}
td
{
 font: menu;
}
.txtfld
{
 font: menu;
 background-color: window;
 color: windowtext;
 border-style: inset;
 padding-top:2px;
 padding-left:2px;
 padding-right:2px;
 padding-bottom:3px;
 margin-top:0px;
 margin-bottom:0px;
 margin-left:0px;
 position:absolute;
}
.clock
{
 font:menu;
 background-color: window;
 color: windowtext;
 border-style: inset;
 padding-top:2px;
 padding-left:2px;
 padding-right:2px;
 padding-bottom:3px;
 margin-top:0px;
 margin-bottom:0px;
 margin-left:0px;
 position:absolute;
 cursor:hand;
}
.gobutton
{
 font:menu;
 padding-bottom:1px;
 padding-top:1px;
 padding-right:1px;
 padding-left:1px;
 border:2px;
 border-style:solid;
 border-color:threedface;
 background-color:threedface;
 color:buttontext;
 margin-bottom:0px;
 margin-left:0px;
 position:absolute;
}
.mogobutton
{
 font:menu;
 padding-bottom:1px;
 padding-top:1px;
 padding-right:1px;
 padding-left:1px;
 border:2px;
 border-style:outset;
 border-color:window;
 background-color:threedface;
 color:buttontext;
 margin-bottom:0px;
 margin-left:0px;
 position:absolute;
}
.mdgobutton
{
 font:menu;
 padding-bottom:1px;
 padding-top:1px;
 padding-right:1px;
 padding-left:1px;
 border:2px;
 border-style:inset;
 border-color:window;
 background-color:threedface;
 color:buttontext;
 margin-bottom:0px;
 margin-left:0px;
 position:absolute;
}
</style>

<script>
<!--
m=navigator.userAgent.toLowerCase().match("msie\\s+(\\d+\\.\\d*)");
ie_version=(m ? parseFloat(m[1]) : 0.0);
-->
</script>

<!-- Optional local script file for overriding settings defined above -->
<script src=preferences.js></script>

<!-- include local search file and apply style overrides -->
<script>
  document.write("<xml id='localsearch' src='" + localsearchurl + "'></xml>");

  document.write("<style>.txtfld{" + txtfldstyle + "} " +
                        ".gobutton{" + buttonstyle + "} " +
                        ".mogobutton{" + buttonstyle + "} " +
                        ".mdgobutton{" + buttonstyle + "} " +
                        ".clock{" + clockstyle + "}</style>");
  actualmenustyle =
      "background:menu;height:18px;" +
      "color:menutext;font-family:Tahoma;padding:1px;font-size:8pt;" +
      menustyle;
  
</script>

<body onload=strt() scroll=no>

<script>
init = true;
selfdrag = false;

// Try to instantiate the launcher tool
var DQSDLauncher = null;
var useExternalBrowser = (launchmode > 0);

try 
{
  if (useExternalBrowser)
    DQSDLauncher = new ActiveXObject("DQSDTools.Launcher");
    
  // If IE is the default browser, then no need to launch it externally
  if (DQSDLauncher)
  {
    var browserPath = DQSDLauncher.pathDefaultBrowser
    if (launchmode == 2 && browserPath.toLowerCase().indexOf("iexplore.exe") > 0)
      useExternalBrowser = false;
  }
}
catch (e)  // Gracefully ignore problems creating the control.
{
  useExternalBrowser = false;
}


// Open a search window either with the default browser or with IE
function openSearchWindow(url)
{
  openNamedSearchWindow(url, "_blank");
}

// Open a search window in an existing frame
function openNamedSearchWindow(url, name)
{
  if (useExternalBrowser && DQSDLauncher)
    DQSDLauncher.OpenDocument(url);
  else 
    window.open(url, name);
}

// Submit a form either with the default browser or with IE
function submitForm(form)
{
  if (useExternalBrowser && DQSDLauncher)
    DQSDLauncher.SubmitForm(form);
  else 
    form.submit();
}


// def() called when the user hits "enter" in the textbox
function def()
{
  var t = document.deff.q.value;

  addhist(t);

  // no search: go to Google

  if (init || t == "")
  {
    openSearchWindow("http://www.google.com/");
    return false;
  }

  // question mark only: show help
  if (t == "?")         { abt(); return false; }

  // exclamation mark only: refresh
  if (t == "!")         { reload(); return false; }

  // detect strings that look like phone numbers
  if (phoneno(t)) return false;

  // detect strings that look like currency conversions
  if (currency(t)) return false;

  // detect math expressions
  if (mathexp(t)) return false;

  // detect translations
  if (babel(t)) return false;

  // detect URLs, filenames, etc to open directly
  if (direct(t)) return false;

  var i;
  for (i = shortcutarray.length - 1; i >= 0; i--)
  {
    var entry = shortcutarray[i];
    if (shortcut(t, entry.code, entry.fun)) return false;
  }

  for (i = commandarray.length - 1; i >= 0; i--)
  {
    var entry = commandarray[i];
    if (shortcut(t, entry.code, entry.fun)) return false;
  }

  // default: Google search
  eval(defaultsearch + "(document.deff.q.value)");
  return false;


}


// detect and strip suffix or prefix and call function
function shortcut(t, s, f)
{
  var doit = false;
  var q;

  if (s.match(/[a-zA-Z]+/))
  {
    if (t.match("^" + s + "\\b"))
    {
      q = t.slice(s.length);
      doit = true;
    }
  }
  else if (t.length >= s.length)
  {
    if (t.slice(t.length-s.length) == s)
    {
      q = t.slice(0, -s.length);
      doit = true;
    }
    else if (t.slice(0, s.length) == s)
    {
      q = t.slice(s.length);
      doit = true;
    }
  }

  if (doit)
  {
    q = q.replace(/^\s*/, '').replace(/\s*$/, '');
    f(q);
    return true;
  }

  return false;
}

function startsorendswith(s, t)
{
  if (t.length >= s.length)
  {
    if (t.slice(t.length-s.length) == s)
    {
      return true;
    }
    else if (t.slice(0, s.length) == s)
    {
      return true;
    }
  }
  return false;
}


// a way of executing a specific search
// while adding the right symbol to the history
function mnu(text, sym)
{
  addhist(document.deff.q.value + sym);
  eval(text + "(document.deff.q.value);");
}



// build the shortcut arrays
function buildshortcuts()
{
  shortcutarray = [];
  commandarray = [];
  menuarray = [];
  urlallowedarray = [];
  exthelparray = [];
  addinternalshortcuts();
  addexternalshortcuts();
}

// IE 5.0 and earlier don't have splice, push
if (!Array.prototype.splice)
{
  function array_splice(ind,cnt)
  {
    removeArray = this.slice(ind,ind+cnt);
    endArray = this.slice(ind+cnt);
    this.length = ind;
    for (var i=2; i<arguments.length; i++)
      this[this.length] = arguments[i];
    for (var i=0; i<endArray.length; i++)
      this[this.length] = endArray[i];
    return removeArray;
  }
  Array.prototype.splice = array_splice;
}

if (!Array.prototype.push)
{
  function array_push()
  {
    for (i=0; i<arguments.length; i++)
      this[this.length] = arguments[i];
    return this.length;
  }
  Array.prototype.push = array_push;
}

function addinternalshortcuts()
{
  var i;
  var txt;
  for (i = 0; i < 10; i++)
  {
    txt = document.all.tags("!").item(i).text.slice(4, -3);
    if (txt.match(/Copyright/)) break;
  }
  if (i >= 10)
  {
    alert("Cannot find license and copyright notice.");
    return;
  }

  var j;
  var pat = new RegExp("^(-?)\t([^\\s]+)\t(.*)\\(([a-z]+)\\)\\s*$");
  var table = txt.match(/\n-?\t[^\n]*/g);


  for (i = 0; i < table.length; i++)
  {
    txt = table[i].replace("\n", "");
    var res = pat.exec(txt);
    if (res)
    {
      addshortcut(res[2], res[3].replace(/\s-\s.*$/, ""),
                  res[3], res[4], res[1] != "-");
    }
    else if (txt.match(/^\s+$/))
    {
      menuarray.push(null);
    }
    else alert("Malformed configuration line:\n" + txt);
  }
}

function addshortcut(c, sd, ld, fn, mf)
{
  try
  {
    var newobj = {code:c, title:sd, desc:ld, fun:eval(fn), fname:fn};
    if (newobj.code.match(/^[a-z]/))
    {
      for (j = 0; j < commandarray.length; j++)
        if (c.length <= commandarray[j].code.length) break;
      commandarray.splice(j, 0, newobj);
    }
    else
    {
      for (j = 0; j < shortcutarray.length; j++)
        if (c.length <= shortcutarray[j].code.length) break;
      shortcutarray.splice(j, 0, newobj);
      if (fn == "che" || fn == "iaw")
        urlallowedarray.push(newobj.code);
    }
    if (mf)
      menuarray.push(newobj);
  }
  catch (ex)
  {
    alert("Error adding search - " + ex.description +
           "\n\nshortcut: \"" +  c + "\"\ntitle: \"" + sd + "\"\ndescription: \"" + ld + "\"\nfunction: \"" + fn + "\"");
  }
}

function addexternalhelp(sc, info)
{
  var newobj = {code:sc, desc:info};
  exthelparray.push(newobj);
}

var searchRoot = null;

function definesearchroot()
{
  try
  {
    searchRoot = document.all("searchxml").selectSingleNode("searches");
  }
  catch (ex) {}

  if (!searchRoot)
    return;

  var localSearches = document.all("localsearch").selectNodes("/searches/search");

  for (var i = 0; i < localSearches.length; i++)
    searchRoot.appendChild(localSearches[i]);
}

definesearchroot();

function insertexternalforms()
{
  if (!searchRoot)
    return;

  var xforms = searchRoot.selectNodes("search/form");
  for (var i = 0; i < xforms.length; i++)
  {
    document.write(xforms[i].xml);
  }
}

function addexternalshortcuts()
{
  if (!searchRoot)
    return;

  var searchNodes = searchRoot.selectNodes("search");
  for (var iSearch = 0; iSearch < searchNodes.length; iSearch++)
  {
    var searchNode = searchNodes[iSearch];
    if (searchNode != null)
    {
      var fn = searchNode.attributes.getNamedItem("function");
      var shortcutNodes = searchNode.selectNodes("shortcut");
      var descriptionNode = searchNode.selectSingleNode("description");
      for (var iShortcuts = 0; iShortcuts < shortcutNodes.length; iShortcuts++)
      {
          addshortcut(shortcutNodes[iShortcuts].text,
                      descriptionNode.text.replace(/\s-\s.*$/, ""),
                      descriptionNode.xml,
                      fn.text, false);
      }
      if (shortcutNodes.length > 0)
      {
          addexternalhelp(shortcutNodes[0].text, descriptionNode.xml);
      }
    }
  }
  return false;
}


// detect URLs, local filenames, etc to open directly
function direct(t)
{
  // exempt specials
  var i;
  for (i = 0; i < urlallowedarray.length; i++)
    if (startsorendswith(urlallowedarray[i], t)) return false;

  // detect strings that look like URLs or filenames
  prot = new RegExp("^(http://|https://|ftp://)([\\-a-z0-9]+\\.)*[\\-a-z0-9]+" +
                    "|^[a-z]:($|\\\\)" +
                    "|^\\\\\\\\[a-z]+($|\\\\($|[a-z]+($|\\\\)))", "i");
  if (prot.exec(t))
  {
    openSearchWindow(t);
    return true;
  }

  // detect strings that look like DNS names
  dns = new RegExp("^www\.([\\-a-z0-9]+\\.)+[\\-a-z0-9]+$" +
                   "|^([\\-a-z0-9]+\\.)+(com|net|org|edu|gov|mil|[a-z]{2})$", "i");
  if (dns.exec(t))
  {
    openSearchWindow("http://" + t);
    return true;
  }
  return false;
}


// detect phone numbers to do a reverse lookup on
function phoneno(t)
{
  // detect strings that look like phone numbers
  phn = new RegExp("^([0-9]{3})\\s*-?\\s*([0-9]{3}\\s*-?\\s*[0-9]{4})$" +
                  "|^\\(([0-9]{3})\\)\\s*([0-9]{3}\\s*-?\\s*[0-9]{4})$", "");
  res = phn.exec(t);
  if (res)
  {
    if (res[1])
    {
      ac=res[1];
      pn=res[2];
    }
    else
    {
      ac=res[3];
      pn=res[4];
    }
    rvsphn(ac, pn);
    return true;
  }
  return false;
}

// detect currency conversion
function currency(t)
{
  // detect strings that look like ABC<CBA or ABC>CBA
  var res = t.match(/([0-9]*.?[0-9]*)(\s*)([A-Za-z]{3})([<>])([A-Za-z]{3})/);

  if (res)
  {
    if (res[4] == '<')
      currxchg(res[1], res[5].toUpperCase(), res[3].toUpperCase());
    else
      currxchg(res[1], res[3].toUpperCase(), res[5].toUpperCase());
    return true;
  }
  return false;
}

function babel(t)
{
  // detect strings that ask for a babelfish translation
  var trans = "(en_zh|en_fr|en_de|en_it|en_ja|en_ko|en_pt|en_es|zh_en|fr_en|fr_de|de_en|de_fr|it_en|ja_en|ko_en|pt_en|ru_en|es_en|" +
               "en-zh|en-fr|en-de|en-it|en-ja|en-ko|en-pt|en-es|zh-en|fr-en|fr-de|de-en|de-fr|it-en|ja-en|ko-en|pt-en|ru-en|es-en)";
  var prot = new RegExp("^" + trans + "(.+)","gi");
  var prot2 = new RegExp("(.+)" + trans + "$","gi");
  if (prot.exec(t))
  {
     var temp1 = t.replace(prot,"$1");
     var temp2 = t.replace(prot,"$2");
     babeltranslate(temp1,temp2);
     return true;
  }
  else if (prot2.exec(t))
  {
     var temp2 = t.replace(prot2,"$1");
     var temp1 = t.replace(prot2,"$2");
     babeltranslate(temp1,temp2);
     return true;
  }
  else
     return false;
}

function babeltranslate(l,q)
{
  //q is the query, l is the language choices
  var prot = new RegExp("^(http://|https://)([\\-a-z0-9]+\\.)*[\\-a-z0-9]+" +
                       "|^[a-z]:($|\\\\)" +
                       "|^\\\\\\\\[a-z]+($|\\\\($|[a-z]+($|\\\\)))", "i");
  var dns = new RegExp("^www\.([\\-a-z0-9]+\\.)+[\\-a-z0-9]+$" +
                   "|^([\\-a-z0-9]+\\.)+(com|net|org|edu|gov|mil|[a-z]{2})$", "i");

  q = q.replace(/^\s*/, '').replace(/\s*$/, '');
  if (dns.exec(q))
  {
    babl.tt.value = "url";
    babl.url.value = "http://" + q;
  }
  else if (prot.exec(q))
  {
    babl.tt.value = "url";
    babl.url.value = q;
  }
  else
  {
    babl.tt.value = "urltext";
    babl.urltext.value = q;
  }
  babl.lp.value = l.replace("-", "_");
  submitForm(babl);
}


// detect numeric math expressions to execute right away
function mathexp(t)
{
  // chop out variables
  var noconst = t.replace(/\b(PI|E|LOG2E|LOG10E|LN2|LN10|SQRT2|SQRT1_2|pi)\b/g, "_");
  // experiment: also allow "longvarname="
  var noconst = noconst.replace(/^[a-zA-Z_]+\s*=/, "a=");
  // it's only an expression if it ends with a digit, paren, or variable
  if (!noconst.match(/\b[a-z]$|[_\d\)]$/)) return false;
  // chop out function names
  var nofunc = noconst.replace(/\b(ln|log10|log2|hex|oct|bin|abs|acos|asin|atan|atan2|ceil|cos|exp|floor|log|max|min|pow|random|round|sin|sqrt|tan)\(/g, "(");
  // it's only an expression if it begins with a digit, paren, or variable - or a minus
  if (!nofunc.match(/^[a-z_]\b|^[x\d\-\.\(]/)) return false;
  // detect numbers
  var nonum = nofunc.replace(/\b(\d+(\.\d*)?)([eE][+-]?\d+)?\b/g, "1");
  var nonum = nonum.replace(/(\.\d+)([eE][+-]?\d+)?\b/g, "1");
  // remove spsaces
  var nospace = nonum.replace(/\s/g, "");
  // only operators and recognized things are allowed
  if (!nospace.match(/^[1_a-z\*\-\+\/\(\),=]+$/)) return false;
  // constants cannot touch
  if (nospace.match(/[1_a-z\)][1_a-z\(]/)) return false;
  // operators cannot touch
  if (nospace.match(/[\*\-\+\/][\*\+\/=]/)) return false;
  // parens must match
  var paren = 0;
  var eq = 0;
  var i;
  for (i = nospace.length - 1; i >= 0; i--)
  {
    var ch = nospace.charAt(i);
    if (eq == 1)
    {
      if (ch < 'a' || ch > 'z') return false;
    }
    else
    {
      if (ch >= 'a' && ch <= 'z' && eval("typeof " + ch) == "undefined") return false;
    }
    if (ch == '=') { eq++; }
    if (ch == ')') { paren++; }
    if (ch == '(') { paren--; }
    if (paren < 0) return false;
    if (eq > 1) return false;
  }

  // looks like an expression: we can calc it
  clc(t);
  return true;
}



// fancy UI: history and cut and paste (via arrow and control keys)

hist = new Array(50);
histedit = new Array(hist.length);
hist[0] = "";
histcount = 1;
histcurr = 0;
histend = 0;

// add an item to the history
function addhist(t)
{
  var i;
  for (i = 0; i < histcount; i++)
    histedit[i] = null;
  hist[histend] = t;
  histend = histend + 1;
  if (histend >= hist.length)
      histend = 0;
  histcurr = histend;
  hist[histend] = "";
  if (histcount < hist.length)
    histcount = histcount + 1;
}

// get the current history entry
function currhist()
{
  if (histedit[histcurr])
      return histedit[histcurr];
  return hist[histcurr];
}

// advance the currently viewed history entry +1 or -1
function advhist(i)
{
  if (i > 0 && histcurr == histend) return;
  if (i < 0 && (histcurr == histend + 1 || histend == histcount - 1 && histcurr == 0)) return;

  if (document.deff.q.value != currhist())
    histedit[histcurr] = document.deff.q.value;

  histcurr = histcurr + i;
  if (histcurr >= histcount)
    histcurr = 0;
  if (histcurr < 0)
    histcurr = histcount - 1;
}

// handle onkeypress: cut-copy-paste, ctrl-n, ctrl-p for next and previous
// we need to do this because for some reason it's not done for us when
// we're docked in the taskbar!
function okp()
{
  if (window.event.keyCode != 14 && window.event.keyCode != 16
      && window.event.keyCode != 3 && window.event.keyCode != 22
      && window.event.keyCode != 23 && window.event.keyCode != 10)
    return true;

  // ctrl-enter just like IE's address bar - Joel's suggestion
  if (window.event.keyCode == 10)
  {
    var t = document.deff.q.value;

    // trim leading and trailing whitespace and punctuation
    t = t.replace(/^[\s~`!@#$%\^&\*()\-=\+{}\[\];:'<>,\.\/\?]*/, '')
         .replace(/[\s~`!@#$%\^&\*()\-=\+{}\[\];:'<>,\.\/\?]*$/, '');

    // prepend www. and append .com
    t = "www." + t + ".com";

    // if it all looks good as a dns name, then history it
    if (direct(t))
    {
       document.deff.q.value = t;
       addhist(t);
    }
    return false;
  }
  if (window.event.keyCode == 3)
  {
    range = document.selection.createRange();
    range.execCommand("Copy");
    return false;
  }
  if (window.event.keyCode == 22)
  {
    range = document.selection.createRange();
    if (range.parentElement().name != "q") return true;
    document.selection.createRange().execCommand("Paste");
    return false;
  }
  if (window.event.keyCode == 23)
  {
    range = document.selection.createRange();
    if (range.parentElement().name != "q") return true;
    document.selection.createRange().execCommand("Cut");
    return false;
  }

  if (window.event.keyCode == 16)
    advhist(-1);
  else
    advhist(1);

  // work around a weird bug
  if (document.deff.q.value == "")
    document.deff.q.value = ".";

  document.deff.q.value = currhist();
  return false;
}

// onkeydown: handle the up and down arrow keys for history
function okd()
{
  if (window.event.keyCode != 38 && window.event.keyCode != 40)
    return true;
  if (window.event.keyCode == 38)
    advhist(-1);
  else
    advhist(1);

  // work around a weird bug
  if (document.deff.q.value == "")
    document.deff.q.value = ".";

  document.deff.q.value = currhist();
  return false;
}

// stub to be replaced if IE 5.5 or better
// strt() called on page load; show help message after 4 seconds
function strt()
{
  rsz();

  if (!clock || clockdelay > 0)
    document.deff.q.value = local(QUICK_SEARCH);

  if (helptime > 0)
  {
    startbanner(clockdelay);
  }
  else
  {
    startclock(clockdelay);
  }
}

bant = null;

// starts the banner timer
function startbanner(delay)
{
  bant=window.setTimeout("banner();", delay);
}

// banner() called to display help message for 8.5 seconds
function banner()
{
  document.deff.q.value = local(HELP_TEXT);
  bant=window.setTimeout("unbanner();", helptime);
}

// called when the banner naturally goes away
function unbanner()
{
  stopbanner();
  if (!clock || clockdelay >0)
    document.deff.q.value = local(QUICK_SEARCH);
  startclock(clockdelay);
}

// called to forcibly clear the banner
function stopbanner()
{
  stopclock();
  if (bant)
    window.clearTimeout(bant);
}



// clr() called when the texbox is given focus
function clr()
{
  if (init)
  {
    document.deff.q.value="";
    init = false;
  }
  stopbanner();
  document.deff.q.className = "txtfld";
  document.deff.q.value=currhist();
  range = document.deff.q.createTextRange();
  range.select();
}

// dodragover() called when dragging over the textbox
function dodragover()
{
  window.event.dataTransfer.dropEffect='copy';
  window.event.returnValue = false;
}

// dodrop() called when something is dropped on the textbox
function dodrop()
{
  if (selfdrag) return true;

  if (init)
  {
    init = false;
  }
  stopbanner();

  window.event.returnValue=false;
  window.event.dataTransfer.dropEffect='copy';
  var q = event.dataTransfer.getData("Text");

  // trim leading and trailing whitespace and punctuation
  q = q.replace(/^[\s~`!@#$%\^&\*()\-=\+{}\[\];:'<>,\.\/\?]*/, '')
       .replace(/[\s~`!@#$%\^&\*()\-=\+{}\[\];:'<>,\.\/\?]*$/, '');
  document.deff.q.value = q;

  mnu("goo", "");
}

// rst() called when the texbox loses focus
function rst()
{
  advhist(0);
  if (init == false && document.deff.q.value=="")
  {
    init = true;
    if (!clock || clockdelay > 0)
      document.deff.q.value = local(QUICK_SEARCH);
  }
  startclock(clockdelay);
}


// a feeling lucky search
function ifl(q)
{
  if (q == "")
  {
    openSearchWindow("http://www.google.com/");
  }
  else
  {
    document.iflf.q.value=q;
    submitForm(iflf);
  }
}

// an ordinary google search
function goo(q)
{
  if (q == "")
  {
    openSearchWindow("http://www.google.com/");
  }
  else
  {
    document.goof.q.value=q;
    submitForm(goof);
  }
}

// do an advanced search
function adv(q)
{
  if (q == "")
  {
    openSearchWindow("http://www.google.com/advanced_search");
  }
  else
  {
    document.advf.q.value=q;
    submitForm(advf);
  }
}

// submit search to yahoo
function yho(q)
{
  if (q == "")
  {
    openSearchWindow("http://www.yahoo.com/");
  }
  else
  {
    document.yhof.p.value=q;
    submitForm(yhof);
  }
}

// attempt yahoo directory listing
function yhd(q)
{
  if (q == "")
  {
    openSearchWindow("http://www.yahoo.com/");
  }
  else
  {
    openSearchWindow("http://dir.yahoo.com/" + q);
  }
}

// altavista search
function alt(q)
{
  if (q == "")
  {
    openSearchWindow("http://www.altavista.com/");
  }
  else
  {
    document.altf.q.value=q;
    submitForm(altf);
  }
}


// 'fast' search
function fst(q)
{
  if (q == "")
  {
    openSearchWindow("http://www.alltheweb.com/");
  }
  else
  {
    document.fstf.query.value=q;
    submitForm(fstf);
  }
}

// excite search
function exc(q)
{
  if (q == "")
  {
    openSearchWindow("http://www.excite.com/");
  }
  else
  {
    document.excf.search.value=q;
    submitForm(excf);
  }
}

// dogpile search
function dog(q)
{
  if (q == "")
  {
    openSearchWindow("http://www.dogpile.com/");
  }
  else
  {
    document.dogf.q.value=q;
    submitForm(dogf);
  }
}

// newsgroup search
function nsg(q)
{
  if (q == "")
  {
    openSearchWindow("http://groups.google.com/");
  }
  else
  {
    document.nsgf.q.value=q;
    submitForm(nsgf);
  }
}


// Google web directory search
function gwd(q)
{
  if (q == "")
  {
    openSearchWindow("http://www.google.com/");
  }
  else
  {
    document.gwdf.q.value=q;
    submitForm(gwdf);
  }
}

// Bloomberg stock ticker search
function stk(q)
{
  if (q == "")
  {
    openSearchWindow("http://www.bloomberg.com/");
  }
  else
  {
    document.stkf.ticker.value=q;
    submitForm(stkf);
  }
}

// Google cache search
function che(q)
{
  if (q == "")
  {
    openSearchWindow("http://www.google.com/");
  }
  else
  {
    document.goof.q.value="cache:" + q;
    submitForm(goof);
  }
}

// Internet Archive search
function iaw(q)
{
  if (q == "")
  {
    openSearchWindow("http://web.archive.org/");
  }
  else if (q.indexOf("://") >= 0)
  {
    openSearchWindow("http://web.archive.org/web/*/" + q);
  }
  else
  {
    openSearchWindow("http://web.archive.org/web/*/http://" + q);
  }
}

// Merriam webster dictionary lookup
function mwd(q)
{
  if (q == "")
  {
    openSearchWindow("http://www.m-w.com/");
  }
  else
  {
    document.mwdf.va.value=q;
    submitForm(mwdf);
  }
}

// Merriam webster thesaurus lookup
function mwt(q)
{
  if (q == "")
  {
    openSearchWindow("http://www.m-w.com/");
  }
  else
  {
    document.mwtf.va.value=q;
    submitForm(mwtf);
  }
}

// Dictionary.com search
function dic(q)
{
  if (q == "")
  {
    openSearchWindow("http://www.dictionary.com/");
  }
  else
  {
    document.dicf.term.value=q;
    submitForm(dicf);
  }
}


// Thesaurus.com search
function ths(q)
{
  if (q == "")
  {
    openSearchWindow("http://www.thesaurus.com/");
  }
  else
  {
    document.thsf.words.value=q;
    submitForm(thsf);
  }
}

// Uchicago thesaurus search
function thsc(q)
{
  if (q == "")
  {
    openSearchWindow("http://machaut.uchicago.edu/");
  }
  else
  {
    document.thscf.word.value=q;
    submitForm(thscf);
  }
}

// Bartleby.com familiar search
function fmq(q)
{
  if (q == "")
  {
    openSearchWindow("http://www.bartleby.com/100/");
  }
  else
  {
    document.fmqf.query.value=q;
    submitForm(fmqf);
  }
}

// Unscrambler, to calculate scrabble scores
function srb(q)
{
  if (q == "")
  {
    openSearchWindow("http://www.concordance.com/unscrambler.htm");
  }
  else
  {
    document.srbf.letters.value=q;
    submitForm(srbf);
  }
}

// Encyclopedia lookup
function enc(q)
{
  if (q == "")
  {
    openSearchWindow("http://www.encyclopedia.com/");
  }
  else
  {
    document.encf.search.value=q;
    submitForm(encf);
  }
}

// Ask Jeeves
function ask(q)
{
  if (q == "")
  {
    openSearchWindow("http://www.askjeeves.com/");
  }
  else
  {
    document.askf.ask.value=q;
    submitForm(askf);
  }
}

// DealTime comparison shopping
function dlt(q)
{
  if (q == "")
  {
    openSearchWindow("http://www.dealtime.com/");
  }
  else
  {
    document.dltf.keyword.value=q;
    submitForm(dltf);
  }
}


// Usenet FAQ search
function faq(q)
{
  if (q == "")
  {
    openSearchWindow("http://www.faqs.org/faqs/");
  }
  else
  {
    document.faqf.query.value=q;
    submitForm(faqf);
  }
}

// Download CNET Search
function cds(q)
{
  if (q == "")
  {
    openSearchWindow("http://download.cnet.com/");
  }
  else
  {
    document.cdsf.qt.value=q;
    submitForm(cdsf);
  }
}

// CNN news search
function cnn(q)
{
  if (q == "")
  {
    openSearchWindow("http://www.cnn.com/");
  }
  else
  {
    document.cnnf.qt.value=q;
    document.cnnf.key.value=q;
    document.cnnf.isp.value="zch";
    submitForm(cnnf);
  }
}


// MSDN web reference search
function mws(q)
{
  if (q == "")
  {
    openSearchWindow("http://msdn.microsoft.com/workshop/c-frame.htm#/workshop/author/default.asp");
  }
  else
  {
    document.mwsf.qu.value=q;
    submitForm(mwsf);
  }
}



// ebay item search
function eby(q)
{
  if (q == "")
  {
    openSearchWindow("http://www.ebay.com/");
  }
  else if (Number(q))
  {
    if ((Number(q) > '99999999') && (Number(q) < '2147483647')) {
      openSearchWindow('http://cgi.ebay.com/aw-cgi/eBayISAPI.dll?MfcISAPICommand=ViewItem&item=' + q);
    }
  }
  else
  {
    document.ebyf.query.value=q;
    submitForm(ebyf);
  }
}


// accuweather forecast search
function acw(q)
{
  if (q == "")
  {
    openSearchWindow("http://www.accuweather.com/adcbin/local_index");
  }
  else
  {
    document.acwf.thisZip.value=q;
    submitForm(acwf);
  }
}

// reverse phone lookup
function rvsphn(ac, pn)
{
  document.rvsphnf.npa.value=ac;
  document.rvsphnf.telephone.value=pn;
  submitForm(rvsphnf);
}

// currency exchange
function currxchg(amt, f, t)
{
  document.xchgform.Amount.value=amt;
  document.xchgform.From.value=f;
  document.xchgform.To.value=t;
  submitForm(xchgform);
}


// mapquest address lookup
function map(q)
{
  res = q.match(/(([^\/;]+)[\/;]\s*|([^,]+),\s*)?(((\w+\s+)*\w+)[,\s]\s*)?(\w\w)(\s+(\d{5}(-\d{4})?))?/i);

  if (!res)
  {
    openSearchWindow("http://www.mapquest.com/");
  }
  else
  {
    document.mapf.address.value=(res[2] ? res[2] : (res[3] ? res[3] :""));
    document.mapf.city.value   =(res[5] ? res[5] : "");
    document.mapf.State.value  =(res[7] ? res[7].toUpperCase() : "");
    document.mapf.Zip.value    =(res[9] ? res[9] : "");
    submitForm(mapf);
  }
}


// switchboard person lookup
function swp(q)
{
  res = q.match(/(((\w+\s+)?\w+)\s+)?(\w+)(\s*\((([^,]+),?\s+)?(\w\w)\))?/);
  if (!res)
  {
     openSearchWindow("http://www.switchboard.com/bin/cgiqa.dll");
  }
  else
  {
    document.swpf.F.value=(res[2] ? res[2] : "");
    document.swpf.L.value=(res[4] ? res[4] : "");
    document.swpf.T.value=(res[7] ? res[7] : "");
    document.swpf.s.value=(res[8] ? res[8].toUpperCase() : "");
    submitForm(swpf);
  }
}

// switchboard business lookup
function swb(q)
{
  res = q.match(/(\w[^\(]*\w)(\s*\((([^,]+),?\s+)?(\w\w)\))?/);
  if (!res)
  {
     openSearchWindow("http://www.switchboard.com/bin/cgidir.dll");
  }
  else
  {
    document.swbf.TYPE.value="";
    document.swbf.C.value="";
    document.swbf.L.value=(res[1] ? res[1] : "");
    document.swbf.T.value=(res[4] ? res[4] : "");
    document.swbf.s.value=(res[5] ? res[5].toUpperCase() : "");
    submitForm(swbf);
  }
}

// switchboard business category lookup
function swc(q)
{
  res = q.match(/(\w[^\(]*\w)(\s*\((([^,]+),?\s+)?(\w\w)\))?/);
  if (!res)
  {
     openSearchWindow("http://www.switchboard.com/bin/cgidir.dll");
  }
  else
  {
    // search near location
    if (res[4])
      document.swbf.TYPE.value="Search near location";
    else
      document.swbf.TYPE.value="";
    document.swbf.C.value=(res[1] ? res[1] : "");
    document.swbf.L.value="";
    document.swbf.T.value=(res[4] ? res[4] : "");
    document.swbf.s.value=(res[5] ? res[5].toUpperCase() : "");
    submitForm(swbf);
  }
}

// yahoo/411 email lookup
function yhe(q)
{
  res = q.match(/(((\w+\s+)?\w+)\s+)?(\w+)(\s*\(((([^,]+),?\s+)?(\w\w)|((\w+.)+(com|net|org|edu|gov|mil|\w{2})))\))?/);
  if (!res)
  {
     openSearchWindow("http://people.yahoo.com/");
  }
  else
  {
    document.yhef.FirstName.value=(res[2] ? res[2] : "");
    document.yhef.LastName.value=(res[4] ? res[4] : "");
    document.yhef.City.value=(res[8] ? res[8] : "");
    document.yhef.State.value=(res[9] ? res[9].toUpperCase() : "");
    document.yhef.Domain.value=(res[10] ? res[10].toLowerCase() : "");
    submitForm(yhef);
  }
}



// bigfoot email lookup
function bfe(q)
{
  res = q.match(/(((\w+\s+)?\w+)\s+)?(\w+)(\s*\((([^,]+),?\s+)?(\w\w)\))?/);
  if (!res)
  {
     openSearchWindow("http://www.bigfoot.com/");
  }
  else
  {
    document.bfef.FirstName.value=(res[2] ? res[2] : "");
    document.bfef.LastName.value=(res[4] ? res[4] : "");
    document.bfef.City.value=(res[7] ? res[7] : "");
    document.bfef.State.value=(res[8] ? res[8].toUpperCase() : "");
    submitForm(bfef);
  }
}

// Pricewatch
function pcw(q)
{
  if (q == "")
  {
    openSearchWindow("http://www.pricewatch.com/");
  }
  else
  {
    document.pcwf.criteria.value = q;
    submitForm(pcwf);
  }
}

// IMDB
function mdb(q)
{
  if (q == "")
  {
    openSearchWindow("http://www.imdb.com/");
  }
  else
  {
    document.mdbf["for"].value = q;
    submitForm(mdbf);
  }
}



// PhoneSpell
function psl(q)
{
  if (q == "")
  {
    openSearchWindow("http://www.phonespell.org/");
  }
  else
  {
    document.pslf.n.value = q;
    submitForm(pslf);
  }
}


// cdnow
function cdn(q)
{
  var res = q.match(/([^\/]+)(\/[AaSsTtLl])?/);

  if (!res)
  {
     openSearchWindow("http://www.cdnow.com/");
  }
  else
  {
    document.cdnf.string.value=(res[1] ? res[1] : "");
    document.cdnf.index.value=(res[2] ? res[2].toLowerCase().substring(1,2) : "a");
    submitForm(cdnf);
  }
}

// cddb
function cdb(q)
{
  var res = q.match(/([^\/]+)((\/)[ats]+)?/);

  if (!res)
  {
     openSearchWindow("http://www.cddb.com/");
  }
  else
  {
    var dope = "";
    if ((res[2].indexOf('a') > -1) || (res[2].indexOf('A') > -1))
      dope += "artist ";
    if ((res[2].indexOf('t') > -1) || (res[2].indexOf('T') > -1))
      dope += "disc ";
    if ((res[2].indexOf('s') > -1) || (res[2].indexOf('S') > -1))
      dope += "track ";

    document.cdbf.q.value=(res[1] ? res[1] : "");
    document.cdbf.f.value=(res[2] ? dope : "artist");
    submitForm(cdbf);
  }
}

// allmusic
function alm(q)
{
  var res = q.match(/([^\/]+)(\/[AaSsTtLlYy])?/);

  if (!res)
  {
     openSearchWindow("http://www.allmusic.com/");
  }
  else
  {
    document.almf.sql.value=(res[1] ? res[1] : "");
    document.almf.opt1.value="1";
    switch (res[2].toLowerCase().substring(1,2))
    {
     case "a": case "A": document.almf.opt1.value="1"; break;
     case "T": case "t": document.almf.opt1.value="2"; break;
     case "s": case "S": document.almf.opt1.value="3"; break;
     case "Y": case "y": document.almf.opt1.value="5"; break;
     case "l": case "L": document.almf.opt1.value="4"; break;
    }
    submitForm(almf);
  }
}

// MSDN all
function msdn(q)
{
  if (q == "")
  {
    openSearchWindow("http://msdn.microsoft.com/library");
  }
  else
  {
    document.msdnf.qu.value = q;
    document.msdnf.scopeid.value = "1"; // all MSDN
    submitForm(msdnf);
  }
}

// MSDN library only
function msdnl(q)
{
  if (q == "")
  {
    openSearchWindow("http://msdn.microsoft.com/library");
  }
  else
  {
    document.msdnf.qu.value = q;
    document.msdnf.scopeid.value = "2"; // MSDN library only
    submitForm(msdnf);
  }
}

// xrefer
function xrefer(q)
{
  if (q == "")
  {
    openSearchWindow("http://www.xrefer.com");
  }
  else
  {
    document.xreferf.term.value = q;
    document.xreferf.shelf.value = "search all"
    submitForm(xreferf);
  }
}

// Google images
function image(q)
{
  if (q == "")
  {
    openSearchWindow("http://images.google.com");
  }
  else
  {
    document.imagef.q.value = q;
    submitForm(imagef);
  }
}

// Half
function half(q)
{
  if (q == "")
  {
    openSearchWindow("http://www.half.com");
  }
  else
  {
    document.halff.keyword.value = q;
    submitForm(halff);
  }
}

// Pricescan ISBN
function isbn(q)
{
  if (q == "")
  {
    openSearchWindow("http://www.pricescan.com/home_books.asp");
  }
  else
  {
    document.isbnf.isbn.value = q;
    submitForm(isbnf);
  }
}

// Sam Spade
function sam(q)
{
  if (q == "")
  {
    openSearchWindow("http://www.samspade.org/");
  }
  else
  {
    document.samw.a.value = q;
    submitForm(samw);
  }
}

// PHP reference
function php(q)
{
  if (q == "")
  {
    openSearchWindow("http://www.php.net/");
  }
  else
  {
    openSearchWindow("http://www.php.net/" + q);
  }
}

// performs the search at http://www.mysql.com/doc
function mys(q)
{
  if (q == "")
  {
    openSearchWindow("http://www.mysql.com/");
  }
  else
  {
    document.mysf.search_query.value=q;
    submitForm(mysf);
  }
}

// offline calculator
function clc(expr)
{
  if (expr.match(/=ERR$/))
    return;

  try
  {
    with(Math)
    {
      var answer = eval(expr);
      if (typeof(answer) == "number")
      {
        // for the sake of pretty decimal numbers,
        // round numbers that are very close to a ten-millionth
        if (abs(answer) >= 0.001 &&
            abs(round(answer * 1e+7) - answer * 1e+7) < 0.001)
          answer = round(answer * 1e+7)/1e+7;
      }
      document.deff.q.value = answer;
    }
  }
  catch (exception)
  {
    document.deff.q.value = expr + "=ERR=";
  }
}


// constants for use in calculator
pi = Math.PI;
ln10 = Math.LN10;
ln2 = Math.LN2;
log10e = Math.LOG10E;
log2e = Math.LOG2E;
sqrt1_2 = Math.SQRT1_2;
sqrt2 = Math.SQRT2;
ln = Math.log;
e = Math.exp(1);

// based log functions
function log10(n) { return ln(n)/ln10; }
function log2(n) { return ln(n)/ln2; }

// hex conversion for use in calculator
function hex(i)
{
  hexChars = "0123456789abcdef";
  var h = "";
  var n = 256;

  while (i < 0)
  {
     if (i + n / 16 > 0) { i += n; break; }
     n = n * n;
  }

  while (i > 0)
  {
     h = hexChars.charAt(i % 16) + h;
     i = Math.floor(i / 16);
  }

  if (h == "")
     h = "0";

  return "0x" + h;
}

// octal conversion for use in calculator
function oct(i)
{
  octChars = "01234567";
  var h = "";
  var n = 512;

  while (i < 0)
  {
     if (i + n / 8 > 0) { i += n; break; }
     n = n * n;
  }

  while (i > 0)
  {
     h = octChars.charAt(i % 8) + h;
     i = Math.floor(i / 8);
  }

  if (h == "")
     h = "0";

  return "0" + h;
}

// binary conversion for use in calculator
function bin(i)
{
  binChars = "01";
  var h = "";
  var n = 16;

  while (i < 0)
  {
     if (i + n / 2 > 0) { i += n; break; }
     n = n * n;
  }

  while (i > 0)
  {
     h = binChars.charAt(i % 2) + h;
     i = Math.floor(i / 2);
  }

  if (h == "")
     h = "0";

  return h;
}



abtw = 0;

// the help dialog box
function closeabt()
{
  var unopened = true;
  try
  {
    unopened = (abtw == 0 || abtw.closed);
  }
  catch (exception) {}

  if (!unopened)
  {
    abtw.close();
    unopened = true;
  }
}


function abt()
{
  if (window.event)
    window.event.cancelBubble = true;

  closeabt();

  {
    var i;
    var txt;
    var exttxt = "";

    for (i = 0; i < 10; i++)
    {
      txt = document.all.tags("!").item(i).text.slice(4, -3);
      if (txt.match(/Copyright/)) break;
    }
    if (i >= 10)
    {
      txt = "Cannot find documentation.";
    }

    for (i = 0; i < exthelparray.length; i++)
    {
      exttxt = exttxt + "<tr><td valign=top class=lb> " +
               exthelparray[i].code +
               " </td><td valign=top class=lg> " +
               exthelparray[i].desc + " </td></tr>";
    }

    txt = txt.replace(/\r\n/g, '\n');
    txt = txt.replace(/\n\*/g, '<li>');
    txt = txt.replace(/\nVer/, '</b><br>Ver');
    txt = txt.replace(/\nCopy/, '<p>Copy');
    txt = txt.replace(/\nDist/, '<br>Dist');
    txt = txt.replace(/(David Bau)/, '<a href=mailto:davidbau@hotmail.com>$1</a>');
    txt = txt.replace(/(GNU.*2)\s\((.*txt)\)/, '<br><a href=$2 target=GNU>$1</a>');
    txt = txt.replace(/\n#[^\n]*/g, '');
    txt = txt.replace(/-?\t([^\s]+)\t([^\(\[]+)\s[\(\[][^\)\]]+[\)\]]/g,
    '<tr><td valign=top class=lb> $1 </td><td valign=top class=lg> $2 </td></tr>');
    txt = txt.replace(/<\/table>/, exttxt + "</table>");
    txt = txt.replace(/\n\n/g, '<p>');
    txt = txt.replace(/\n/g, ' ');
    txt = txt.replace(/----/, '</center>');
    var basedir = window.location.href;
    basedir = basedir.substring(0, basedir.lastIndexOf('/') + 1);
    txt = txt.replace(/(view-source:)/g, '$1' + basedir);
    mesg = "<title>About Dave's Quick Search Deskbar</title>";
    mesg = mesg + "<style>body{margin:20px;border:0;padding:0;background-color:threedface;font-family:Tahoma,Arial;scrollbar-track-color:threedface}" +
           "td{font-size:8pt;border-collapse:collapse} .lg{background:lightgreen;} .lb{background:skyblue;}</style>";
    mesg = mesg + "<body scroll=yes><table height=100% width=100%><tr><td><center style=font-size:9pt><b>";
    mesg = mesg + txt + "</td></tr></table>";
    opts = "height=480, width=420, menubar=no, scrollbars=yes, resizable=yes, toolbar=no, status=no";
    abtw = window.open("about:blank", "_blank", opts);
    abtw.document.write(mesg);
  }
  abtw.focus();
}

function reload()
{
  closeabt();
  window.location.reload(false);
}

<!-- code to take advantage of IE 5.5 popup window -->

function mi(name, func, sym)
{
  popheight += 18;
  qsym = sym;
  if (sym == "\\")
    qsym = "\\\\";

  return "<tr " +
    "onmouseover=\"this.style.background='highlight'; this.style.color='highlighttext';\"" +
    "onmouseout=\"this.style.background='menu'; this.style.color='menutext';\"" +
    "onmouseup=\"this.style.background='menu'; this.style.color='menutext';parent.mnu('" + func + "', &quot;" + qsym + "&quot;);\"" +
    "style=\"" + actualmenustyle + "\">" +
    "<td nowrap style=padding-left:20px;>" +
    name +
    "</td><td nowrap style=padding-left:10px;padding-right:10px;>" + sym + "</td></tr>";
}

function dv()
{
  if (shrink) return "";
  popheight += 10;
  return "<tr><td colspan=2 style='height:10px;padding-left:2px;padding-right:2px'><hr style='position:absolute;top=" + (popheight-10) + "px;'></td></tr>";
}

function colbreak()
{
  if (!shrink) return "";
  popwidth += 220;
  popheight = 4;
  return "</table></td><td valign=top><table cellpadding=0 cellspacing=0 width=100%>";
}

function buildpop()
{
  pophelp = window.createPopup();
  popheight = 4;
  popwidth = 240;
  shrink = (window.screen.height <= 700);
  var s = "<table cellpadding=0 cellspacing=0 width=100%><tr><td valign=top>" +
      "<table cellpadding=0 cellspacing=0 width=100%>" +
      mi("About This Toolbar", "abt", "");
  var i;
  for (i = menuarray.length - 1; i >= 0; i--)
  {
    var entry = menuarray[i];
    if (entry == null)
    {
       s = s + dv();
    }
    else
    {
       s = s + mi(entry.title, entry.fname, entry.code);
    }
  }
  s = s +  mi("Google Search", "goo", "") +
           "</table>" +
           "</td><tr></table>";

  pophelp.document.body.innerHTML = s;
  pophelp.document.body.style.border="outset 2px";
  pophelp.document.body.style.background='menu';
}

pophelpisopen=false;

function watchpopup(popvarname)
{
  var isopen = eval(popvarname + "isopen = " + popvarname + ".isOpen");
  if (isopen)
  {
    window.setTimeout("watchpopup('" + popvarname + "');", 100);
  }
}

function showpop()
{
  if (ie_version < 5.5)
    return false;

  if (window.event.button == 2)
    return false;

  window.event.cancelBubble = true;
  if (pophelpisopen)
  {
    pophelp.hide();
    return false;
  }
  else
  {
    var rows = pophelp.document.all.tags("TR");
    var i;
    for (i = 0; i < rows.length; i++)
    {
       rows[i].style.background="menu";
       rows[i].style.color="menutext";
    }
    pophelp.show(document.body.clientWidth - popwidth, -popheight, popwidth, popheight, document.body);
    window.setTimeout("queuefocus();", 0);
    watchpopup("pophelp");
    return false;
  }
}

function queuefocus()
{
  document.deff.q.focus();
}
</script>

  <table align=left
        border=0
        cellpadding=0
        cellspacing=0>
   <tr>
   <form name=deff
         target=_blank
         action=http://www.google.com/search
         method=get
         onsubmit="return def();">
     <td>
     <nobr>
     <input name=q
            type=text
            class=txtfld
            onfocus=clr()
            ondragstart="selfdrag=true;"
            ondragend="selfdrag=false;"
            ondragover=dodragover()
            ondrop=dodrop()
            onblur=rst()
            onhelp=showpop()
            oncontextmenu="return showcal();"
            onkeydown="return okd();"
            onkeypress="return okp();"
            value=""
            size=20
            maxlength=256
            tabindex=0
            autocomplete=off><script>

// immediate initialization scripts

// define external functions

if (searchRoot)
{
  var xscripts = searchRoot.selectNodes("search/script");

  for (var i = 0; i < xscripts.length; i++)
  {
    eval(xscripts[i].text);
  }
}


// then build the shortcut arrays
buildshortcuts();

// only build the popup button in IE 5.5 or better

dopopup = (ie_version >= 5.5);

// only build the popup if createPopup works

if (dopopup)
{
  try
  {
    buildpop();
  }
  catch (exception)
  {
    dopopup = false;
  }
}

if (dopopup)
{
  document.write(
    "<input class=gobutton type=button"
  + "       name=gobutton"
  + "       value=&#xBB;"
  + "       onmousedown=this.className='mdgobutton';showpop();"
  + "       ondblclick=showpop();"
  + "       oncontextmenu=\"return showcal();\""
  + "       onmouseup=this.className='mogobutton'"
  + "       onmouseover=this.className='mogobutton'"
  + "       onmouseout=this.className='gobutton'"
  + "       tabindex=-1>");
}
</script></nobr>
    </td>
   </form>
  </tr>
  <tr cellpadding=0>
   <td id=info style="display:none">
    <img width=0 height=36><br>
    <b><a style=text-decoration:none;color:black href=http://notesbydave.com/toolbar/searchdoc.htm target=_blank tabindex=-1>
      Dave's Quick Search Taskbar Toolbar</a></b>
    <br>
    Designed to be placed on the Windows taskbar.<br>
    For documentation,
    <a href="about:" onclick="abt(); return false;" tabindex=-1>click here</a>.
   </td>
  </tr>
 </table>

<script>
insertexternalforms();
</script>

<!-- regular google search -->
<form name=goof
      target=_blank
      action=http://www.google.com/search
      method=get>
 <input name=q
        type=hidden>
</form>

<!-- feeling lucky search -->
<form name=iflf
      target=_blank
      action=http://www.google.com/search
      method=get>
 <input name=q
        type=hidden>
 <input name=btnI
        value="I'm Feeling Lucky"
        type=hidden>
</form>

<!-- advanced search -->
<form name=advf
      target=_blank
      action=http://www.google.com/advanced_search
      method=get>
 <input name=q
        type=hidden>
</form>

<!-- yahoo search -->
<form name=yhof
      target=_blank
      action=http://search.yahoo.com/bin/search
      method=get>
 <input name=p
        type=hidden>
</form>

<!-- google web directory search -->
<form name=gwdf
      target=_blank
      action=http://www.google.com/search
      method=get>
 <input name=cat
        type=hidden
        value=gwd/Top>
 <input name=q
        type=hidden>
</form>

<!-- altavista search -->
<form name=altf
      target=_blank
      action=http://www.altavista.com/sites/search/web
      method=get>
  <input name=q
         type=hidden>
  <input name=pg
         type=hidden
         value=q>
  <input name=kl
         type=hidden
         value=XX>
</form>

<!-- 'fast' search -->
<form name=fstf
      target=_blank
      action=http://www.alltheweb.com/search
      method=get>
  <input name=cat
         type=hidden
         value=web>
  <input name=lang
         type=hidden
         value=any>
  <input name=query
         type=hidden>
</form>

<!-- excite search -->
<form name=excf
      target=_blank
      action=http://search.excite.com/search.gw
      method=get>
  <input name=c
         type=hidden
         value=web>
  <input name=search
         type=hidden>
</form>

<!-- dogpile search -->
<form name=dogf
      target=_blank
      action=http://search.dogpile.com/texis/search
      method=get>
  <input name=fs
         type=hidden
         value=web>
  <input name=geo
         type=hidden
         value=no>
  <input name=q
         type=hidden>
</form>

<!-- newsgroup search -->
<form name=nsgf
      target=_blank
      action=http://groups.google.com/groups
      method=get>
 <input name=q
        type=hidden>
</form>

<!-- merriam webster dictionary search -->
<form name=mwdf
      target=_blank
      action=http://www.m-w.com/cgi-bin/dictionary
      method=post>
 <input name=va
        type=hidden>
</form>


<!-- merriam webster thesaurus search -->
<form name=mwtf
      target=_blank
      action=http://www.m-w.com/cgi-bin/thesaurus
      method=post>
  <input type=hidden name=book value=Thesaurus>
  <input name=va type=hidden>
</form>


<!-- dictionary.com search -->
<form name=dicf
      target=_blank
      action=http://www.dictionary.com/cgi-bin/dict.pl
      method=get>
 <input name=term
        type=hidden>
 <input name=db
        value=*
        type=hidden>
</form>


<!-- thesaurus.com search -->
<form name=thsf
      target=_blank
      action=http://www.thesaurus.com/cgi-bin/search
      method=get>
 <input name=config
        type=hidden
        value=roget>
 <input name=words
        type=hidden>
</form>

<!-- thesaurus search 2 -->
<form name=thscf
      target=_blank
      action=http://machaut.uchicago.edu/cgi-bin/ROGET.sh
      method=get>
 <input name=word
        type=hidden>
</form>

<!-- bloomberg stock quote search -->
<form name=stkf
      target=_blank
      action=http://quote.bloomberg.com/analytics/bquote.cgi
      method=get>
  <input name=ticker
         type=hidden>
</form>

<!-- Bartleby familiar quote search -->
<form name=fmqf
      target=_blank
      action=http://www.bartleby.com/cgi-bin/texis/webinator/sitesearch
      method=get>
  <input name=FILTER
         type=hidden
         value=col100>
  <input name=query
         type=hidden>
</form>

<!-- scrabble unscrambler -->
<form name=srbf
      target=_blank
      action=http://www.concordance.com/cgi-bin/unscrambler.pl
      method=post>
  <input name=letters
         type=hidden>
</form>

<!-- encyclopedia lookup -->
<form name=encf
      target=_blank
      action=http://www.encyclopedia.com/cgi-bin/search.cgi
      method=post>
  <input name=search
         type=hidden>
</form>

<!-- ask jeeves --->
<form name=askf
      target=_blank
      action=http://www.askjeeves.com/main/askjeeves.asp
      method=post>
  <input name=ask
         type=hidden>
</form>

<!-- dealtime comparison shopping search -->
<form name=dltf
      target=_blank
      action=http://www.dealtime.com/GS2/GS2StatReDirect
      method=get>
  <input type="hidden" name="nFormID" VALUE="">
  <input type="hidden" name="nParentFormID" VALUE="0">
  <input type="hidden" name="NavigationGroupId" VALUE="1">
  <input type="hidden" name="WeightGroupId" VALUE="1">
  <input type="hidden" name="bParent" VALUE="on">
  <input type="hidden" name="uid" VALUE="">
  <input type="hidden" name="bid" VALUE="1">
  <input type="hidden" name="Operator" value="2">
  <input type="hidden" name="keyword">
</form>

<!-- usenet FAQ search -->

<form name=faqf
      target=_blank
      method=post
      action=http://www.faqs.org/cgi-bin/faqs/faqsearch>
  <input name=archive type=hidden value=faqs>
  <input name=case type=hidden value=off>
  <input name=whole type=hidden value=on>
  <input name=maxlines type=hidden value=30>
  <input name=errors type=hidden value=1>
  <input name=maxfiles type=hidden value=50>
  <input name=meta type=hidden value=enabled>
  <input name=query type=hidden>
</form>


<!-- Download CNET search -->

<form name=cdsf
      target=_blank
      method=get
      action=http://download.cnet.com/downloads/search/redirector/1,10207,0-0,00.html>
      <input type=hidden name=tg value=dl-10000>
      <input type=hidden name=cn value="">
	  <input type=hidden name=tt value=srch>
	  <input type=hidden name=qt>
</form>

<!-- CNN Search via looksmart -->

<form name=cnnf
      target=_blank
      method=get
      action=http://cnn.looksmart.com/r_search>
  <input name=sites type=hidden value=CNN>
  <input name=qc type=hidden value="">
  <input name=col type=hidden value=cnni>
  <input name=qm type=hidden value=0>
  <input name=st type=hidden value=1>
  <input name=nh type=hidden value=10>
  <input name=lk type=hidden value=1>
  <input name=rf type=hidden value=1>
  <input type=hidden name=look value="">
  <input type=hidden name=key value="">
  <input type="hidden" name="venue" value="all">
  <input type="hidden" name="keyword" value="">
  <input type=hidden name=qp value="">
  <input type=hidden name=comefrom value="izch-search">
  <input type=hidden name=isp value=zcb>
  <input type="hidden" name="search" value="0">
  <input type="hidden" name=qt>
</form>


<!-- MSDN search for DHTML references -->

<!-- This needs to be updated
<form name=mwsf
      target=_blank
      action=http://search.microsoft.com/us/dev/default.asp
      method=get>
  <input type=hidden name=so value=RECCNT>
  <input type=hidden name=qu>
  <input type=hidden name=boolean value=ALL>
  <input type=hidden name=ig value=02>
  <input type=hidden name=i value=29>
  <input type=hidden name=p value=1>
  <input type=hidden name=nq value=NEW>
</form>
-->

<!-- Ebay search for auction items -->

<form name=ebyf
      target=_blank
      action=http://search.ebay.com/search/search.dll
      method=get>
  <input type=hidden name="MfcISAPICommand" value="GetResult">
  <input type=hidden name=ht value=1>
  <input type=hidden name="SortProperty" value="MetaEndSort">
  <input type=hidden name=query>
</form>


<!-- Accuweather forecast search -->

<form name=acwf
      target=_blank
      action=http://www.accuweather.com/adcbin/local_index
      method=get>
  <input type=hidden name=nav value=home>
  <input type=hidden name=thisZip>
</form>


<!-- AnyWho reverse phone number lookup -->

<form name=rvsphnf
      target=_blank
      action=http://www.anywho.com/qry/wp_rl
      method=get>
  <input type=hidden name=npa>
  <input type=hidden name=telephone>
</form>


<!-- Mapquest Address Lookup -->
<form name=mapf
      target=_blank
      action=http://www.mapquest.com/cgi-bin/ia_find
      method="GET">
  <input type=hidden name=link value=btwn/twn-map_results>
  <input type=hidden name=random" value=565>
  <input type=hidden name=event value=find_search>
  <input type=hidden name=SNVData value="">
  <input type=hidden name=address>
  <input type=hidden name=city>
  <input type=hidden name=State>
  <input type=hidden name=Zip>
</form>




<!-- Switchboard business address lookup -->
<form name=swbf
      target=_blank
      action=http://www.switchboard.com/bin/cgidir.dll
      method=get>
  <input type=hidden name=FUNC value=FORMATSEARCH>
  <input type=hidden name=MEM value=1>
  <input type=hidden name=TYPE>
  <input type=hidden name=C>
  <input type=hidden name=L>
  <input type=hidden name=T>
  <input type=hidden name=s>
</form>

<!-- Switchboard personal address lookup -->
<form name=swpf
      target=_blank
      action=http://www.switchboard.com/bin/cgiqa.dll
      method=get>
  <input type=hidden name=SR>
  <input type=hidden name=MEM value=1>
  <input type=hidden name=F>
  <input type=hidden name=L>
  <input type=hidden name=T>
  <input type=hidden name=s>
</form>


<!-- Yahoo/411 email lookup -->
<form name=yhef
      target=_blank
      action="http://email.people.yahoo.com/py/psSearch.py"
      method=get>
  <input type=hidden name="FirstName">
  <input type=hidden name="LastName">
  <input type=hidden name="City">
  <input type=hidden name="State">
  <input type=hidden name="Domain">
  <input type=hidden name="OldEmail">
  <input type=hidden name="SmartName">
  <input type=hidden name="OrgName">
  <input type=hidden name="OrgType" value="n">
  <input type=hidden name="OrgYrS" value="">
  <input type=hidden name="OrgYrF" value="">
  <input type=hidden name="srch" value="adv">
</FORM>


<!-- Bigfoot email lookup -->
<form name=bfef
      target=_blank
      action=http://search.bigfoot.com/SEARCH
      method=post>
  <input type=hidden name=FormName value=Listing>
  <input type=hidden name="locale" value="en">
  <input type=hidden name="from" value="bigfoot">
  <!--input type=hidden name="dyn" value="NoRef:20334"-->
  <input type=hidden name="FirstName">
  <input type=hidden name="LastName">
  <input type=hidden name="City">
  <input type=hidden name="State">
  <input type=hidden name="EmailSearch" value="1">
</form>

<!-- IMDB lookup -->
<form name=mdbf
      target=_blank
      action=http://www.imdb.com/Find
      method=post>
  <input type=hidden name="select" value="All">
  <input type=hidden name="for">
  <input type=hidden name="Go" value="Go">
</form>

<!-- Pricewatch lookup -->
<form name=pcwf
      target=_blank
      action=http://brook.pricewatch.com/search/search.asp
      method=get>
  <input type=hidden name="criteria">
</form>

<!-- PhoneSpell lookup -->
<form name=pslf
      target=_blank
      action=http://www.phonespell.org/combo.cgi
      method=get>
  <input type=hidden name=n>
</form>

<!-- CDNow lookup -->
<form name=cdnf
      target=_blank
      action=http://www.cdnow.com/cgi-bin/mserver/pagename=/RP/CDN/FIND/popsearch.html
      method=post>
  <input type=hidden name="string">
  <input type=hidden name="index">
</form>

<!-- CDDB lookup -->
<form name=cdbf
      target=_blank
      action="http://www.cddb.com/php/search1.php3">
  <input type=hidden name="f">
  <input type=hidden name="q">
</form>

<!-- AllMusic lookup -->
<form name=almf
      target=_blank
      action="http://www.allmusic.com/cg/amg.dll"
      method=post>
  <input type=hidden name="P" value="amg">
  <input type=hidden name="uid" value="SEARCH">
  <input type=hidden name="opt1">
  <input type=hidden name="sql">
</form>

<!-- xe currency conversion -->
<form name=xchgform
      target=_blank
      action=http://www.xe.com/ucc/convert.cgi
      method=post>
  <input type=hidden name=Amount>
  <input type=hidden name=From>
  <input type=hidden name=To>
</form>

<!-- Samspade lookup -->
<form name=samw
      target=_blank
      action=http://www.samspade.org/t/lookat
      method=get>
  <input type=hidden name="a">
</form>

<!-- Pricescan ISBN lookup -->
<form name=isbnf
      target=_blank
      action=http://www.pricescan.com/books/BookDetail.asp
      method=get>
  <input type=hidden name="type" id="type" value="isbn">
  <input type=hidden name="isbn" id="isbn">
</form>

<!-- Half lookup -->
<form name=halff
      target=_blank
      action=http://www.half.com/search/search.jsp
      method=get>
  <input type=hidden name="product" value="all">
  <input type=hidden name="keyword">
</form>

<!-- Image lookup -->
<form name=imagef
      target=_blank
      action=http://images.google.com/images
      method=get>
  <input type=hidden name="q">
</form>

<!-- MSDN library lookup -->
<form name=msdnf
      target=_blank
      action=http://msdn.microsoft.com/library/shared/searchtab/searchHandoff.asp
      method=get>
  <input type=hidden id="qu" name="qu">
  <input type=hidden name="handoffurl" value="/isapi/gosearch.asp?TARGET=/us/dev/default.asp">
  <input type=hidden name="stcfg" value="/library/searchtabconfig.xml">
  <input type=hidden Name="scopeid" Value="2"><!-- 1 = All MSDN, 2 = Library only -->
</form>

<!-- xrefer lookup -->
<form name=xreferf
      target=_blank
      action=http://www.xrefer.com/results.jsp
      method=get>
  <input type=hidden name="shelf">
  <input type=hidden name="term">
</form>

<!-- MySQL manual -->
<form name=mysf
      target=_blank
      action=http://www.mysql.com/doc/manual.php
      method=get>
  <input type="hidden" name="search_query">
  <input type="hidden" name="depth" value="0">
</form>

<!-- Babelfish translation -->
<form name=babl
      target=_blank
      action=http://babelfish.altavista.com/tr
      method=post>
  <input type=hidden name="doit" value="done">
  <input type=hidden name="lp">
  <input type=hidden name="tt">
  <input type=hidden name="urltext">
  <input type=hidden name="url">
</form>



<!-- script to show time when idle -->
<script>

var clocktimer = null;
var clockrunning = false;
var clockformat = clocklongform;

// Date formatting code adapted from
// http://www.mattkruse.com/javascript/date/source.html

var MONTH_NAMES = 
{
  en: Array('January','February','March','April','May','June','July','August','September','October','November','December','Jan','Feb','Mar','Apr','May','Jun','Jul','Aug','Sep','Oct','Nov','Dec'),
  es: Array('Enero','Febrero','Marzo','Abril','Mayo','Junio','Julio','Agosto','Septiembre','Octubre','Noviembre','Diciembre','Ene','Feb','Mar','Abr','May','Jun','Jul','Ago','Sep','Oct','Nov','Dic'),
  fr: Array('Janvier','Fvrier','Mars','Avril','Mai','Juin','Juillet','Aot','Septembre','Octobre','Novembre','Dcembre','Janv', 'Fvr', 'Mars', 'Avr', 'Mai', 'Juin', 'Juil', 'Aot', 'Sept', 'Oct', 'Nov', 'Dc'),
  de: Array('Januar', 'Februar', 'Mrz', 'April', 'Mai', 'Juni', 'Juli', 'August', 'September', 'Oktober', 'November', 'Dezember', 'Jan', 'Feb', 'Mr', 'Apr', 'Mai', 'Jun', 'Jul', 'Aug', 'Sep', 'Okt', 'Nov', 'Dez'),
  no: Array('Januar','Februar','Mars','April','Mai','Juni','Juli','August','September','Oktober','November','Desember','Jan','Feb','Mar','Apr','Mai','Jun','Jul','Aug','Sep','Okt','Nov','Des'),
  nl: Array('Januari','Februari','Maart','April','Mei','Juni','Juli','Augustus','September','Oktober','November','December','Jan','Feb','Mrt','Apr','Mei','Jun','Jul','Aug','Sep','Okt','Nov','Dec'),
  dk: Array('Januar','Februar','Marts','April','Maj','Juni','Juli','August','September','Oktober','November','December','Jan','Feb','Mar','Apr','Maj','Jun','Jul','Aug','Sep','Okt','Nov','Dec'),
  pt: Array('Janeiro','Fevereiro','Maro','Abril','Maio','Junho','Julho','Agosto','Setembro','Outubro','Novembro','Dezembro','Jan','Fev','Mar','Abr','Mai','Jun','Jul','Ago','Set','Out','Nov','Dez'),
  it: Array('Gennaio', 'Febbraio', 'Marzo', 'Aprile', 'Maggio', 'Giugno', 'Luglio', 'Agosto', 'Settembre', 'Ottobre', 'Novembre', 'Dicembre', 'Gen', 'Feb', 'Mar', 'Apr', 'Mag', 'Giu', 'Lug', 'Ago', 'Set', 'Ott', 'Nov', 'Dic')
};

var DAY_NAMES = 
{
  en: Array('Sunday', 'Monday', 'Tuesday', 'Wednesday', 'Thursday', 'Friday', 'Saturday', 'Sun', 'Mon', 'Tue', 'Wed', 'Thu', 'Fri', 'Sat'),
  es: Array('Domingo','Lunes','Martes','Mircoles','Jueves','Viernes','Sbado','Dom','Lun','Mar','Mie','Jue','Vie','Sab'),
  fr: Array('Dimanche','Lundi','Mardi','Mercredi','Jeudi','Vendredi','Samedi','Dim','Lun','Mar','Mer','Jeu','Ven','Sam'),
  de: Array('Sonntag', 'Montag', 'Dienstag', 'Mittwoch', 'Donnerstag', 'Freitag', 'Samstag', 'Son', 'Mon', 'Die', 'Mit', 'Don', 'Fre', 'Sam'),
  no: Array('Sndag','Mandag','Tirsdag','Onsdag','Torsdag','Fredag','Lrdag','Sn','Man','Tir','Ons','Tor','Fre','Lr'),
  nl: Array('Zondag','Maandag','Dinsdag','Woensdag','Donderdag','Vrijdag','Zaterdag','Zon','Maa','Din','Woe','Don','Vrij','Zat'),
  dk: Array('Sndag', 'Mandag', 'Tirsdag', 'Onsdag', 'Torsdag', 'Fredag', 'Lrdag', 'Sn', 'Man', 'Tir', 'Ons', 'Tor', 'Fre', 'Lr'),
  pt: Array('Domingo','Segunda','Tera','Quarta','Quinta','Sexta','Sbado','Dom','Seg','Ter','Qua','Qui','Sex','Sab'),
  it: Array('Domenica', 'Luned', 'Marted', 'Mercoled', 'Gioved', 'Venerd', 'Sabato', 'Dom', 'Lun', 'Mar', 'Mer', 'Gio', 'Ven', 'Sab')
 };

var QUICK_SEARCH =
{
  en: "Quick Search",
  es: "Bsqueda Rpida",
  fr: "Recherche rapide",
  no: "Hurtigsk",
  nl: "Snelzoek",
  dk: "Hurtig Sgning",
  pt: "Pesquisa Rpida"
};

var HELP_TEXT =
{
  en: "Type ? for help",
  es: "Escriba ? para ayuda",
  fr: "Saisir ? pour l'aide",
  no: "Skriv ? for hjelp",
  nl: "Typ ? voor hulp",
  dk: "Skriv ? for hjlp",
  pt: "Digite ? para ajuda"
};

var SEARCH_TITLE =
{
  en: "Search",
  fr: "Chercher"
}

var NEXT_MONTH =
{
  en: "Next month"
}

var PREV_MONTH =
{
  en: "Previous month"
}

var NEXT_YEAR =
{
  en: "Next year"
}

var PREV_YEAR =
{
  en: "Previous year"
}

var GO_TO_TODAY =
{
  en: "Go to today"
}


function getMonthName(m)
{
  var arr = MONTH_NAMES[language];
  if (!arr) arr = MONTH_NAMES["en"];
  return arr[m - 1];
}

function getDayName(d)
{
  var arr = DAY_NAMES[language];
  if (!arr) arr = DAY_NAMES["en"];
  return arr[d - 1];
}

function local(stringmap)
{
  var qs = stringmap[language];
  if (!qs) return stringmap["en"];
  return qs;
}

document.title=local(SEARCH_TITLE);


function formatdate(date,format)
{
  format = format+"";
  var result = "";
  var i_format = 0;
  var c = "";
  var token = "";
  var y = date.getYear()+"";
  var M = date.getMonth()+1;
  var d = date.getDate();
  var H = date.getHours();
  var m = date.getMinutes();
  var s = date.getSeconds();
  var E = date.getDay() + 1;
  var yyyy,yy,MMMM,MMM,MM,dd,hh,h,mm,ss,ampm,AMPM,HH,H,EEE,EEEE,E;

  // Convert real date parts into formatted versions

  // Year
  if (y.length < 4)
    y = y-0+1900;
  y = ""+y;
  yyyy = y;
  yy = y.substring(2,4);

  // Month
  MM = ((M < 10) ? "0" + M : M);
  MMMM = getMonthName(M);
  MMM = getMonthName(M+12);

  // Day of month
  dd = ((d < 10) ? "0" + d : d);

  // Day of week
  EEEE = getDayName(E);
  EEE = getDayName(E+7);

  // Hour
  h = ((H > 12) ? H - 12 : H);
  if (h == 0) h = 12;
  hh = ((h < 10) ? "0"+h : h);
  HH = ((H < 10) ? "0"+H : H);

  // AM/PM
  AMPM = ((H >= 12) ? "PM" : "AM");
  ampm = ((H >= 12) ? "pm" : "am");

  // Minute
  mm = ((m < 10) ? "0" + m : m);

  // Second
  if (s < 10) { ss = "0"+s; }
    else { ss = s; }

  // Now put them all into an object!
  var value = new Object();
  value["yyyy"] = yyyy;
  value["yy"] = yy;
  value["y"] = y;
  value["MMMM"] = MMMM;
  value["MMM"] = MMM;
  value["MM"] = MM;
  value["M"] = M;
  value["dd"] = dd;
  value["d"] = d;
  value["hh"] = hh;
  value["h"] = h;
  value["HH"] = HH;
  value["H"] = H;
  value["mm"] = mm;
  value["m"] = m;
  value["ss"] = ss;
  value["s"] = s;
  value["a"] = ampm;
  value["A"] = AMPM;
  value["E"] = E;
  value["EEE"] = EEE;
  value["EEEE"] = EEEE;
  while (i_format < format.length)
  {
    // Get next token from format string
    c = format.charAt(i_format);
    token = "";
    while ((format.charAt(i_format) == c) && (i_format < format.length))
    {
      token += format.charAt(i_format);
      i_format++;
    }
    if (value[token] != null)
    {
      result = result + value[token];
    }
    else
    {
      result = result + token;
    }
  }
  return result;
}

function advanceclock()
{
  stopbanner();
  clocktimer = setTimeout("advanceclock()", clockupdate);
  clockrunning = true;
  paintclock();
}

function paintclock()
{
  // Display date and time
  document.deff.q.className = "clock";
  var now = new Date();
  document.deff.q.value = formatdate(now, clockformat);
  if (clocktooltipform && clocktooltipform != "")
  {
    document.deff.q.title = formatdate(now, clocktooltipform);
  }
}

function startclock(delay)
{
  if (clock && !clockrunning)
  {
    clocktimer = setTimeout("advanceclock()", delay);
    clockrunning = true;
  }
}

function stopclock()
{
  if (clockrunning)
    clearTimeout(clocktimer);
  document.deff.q.title = "";
  clockrunning = false;
}

</script>


<!-- script to eliminate Go button if window is narrow -->

<script>
gowidth = -1;
textheight = -1;

function rsz()
{
  if (gowidth < 0)
  {
    if (dopopup)
       gowidth = document.deff.gobutton.offsetWidth;
    else
       gowidth = 0.0;

    textheight = document.deff.q.offsetHeight;
    
    // use script to work around padding change in ie5.5
    if (ie_version >= 5.5)
    {
      textheight = textheight + 3;
    }

    if ((textheight * 1.25 >= document.body.clientHeight) &&
        (textheight * 0.75 <= document.body.clientHeight))
    {
      textheight = document.body.clientHeight;
    }

    document.deff.q.style.height = textheight;
  }

  if (document.body.clientHeight > 128)
    document.all.info.style.display="block";
  else
    document.all.info.style.display="none";

  var targetwidth = document.body.clientWidth - gowidth;

  if (dopopup)
  {
    if (targetwidth < clocklongwidth)
    {
      document.deff.gobutton.style.display="none";
      targetwidth = document.body.clientWidth;
    }
    else
    {
      document.deff.gobutton.style.display="inline";
      document.deff.gobutton.style.left = targetwidth;
      document.deff.gobutton.style.height = textheight;
    }
  }

  if (targetwidth < clocklongwidth)
    clockformat = clockshortform;
  else
    clockformat = clocklongform;

  document.deff.q.style.width=targetwidth;

  if (clockrunning)
     paintclock();
}

rsz();
document.body.onresize=rsz;

</script>


<SCRIPT>
/**
 * script to display a popup calendar
 * added by Sidney Chong (sidney@allomail.com) 12/12/2001
 **/

//vars used by the calendar script
var DAYS_OF_WEEK = 7;    // "constant" for number of days in a week
var DAYS_OF_MONTH = 31;    // "constant" for number of days in a month

var Calendar = new Date(); //stores the date the user is looking at
var popcal = null;
var popcalisopen = false;

function showcal()
{
  if (ie_version < 5.5)
    return true;

  if (popcal != null)
  {
    if (popcalisopen)
    {
      popcal.hide();
      return false;
    }
  }
  else
  {
    popcal = window.createPopup();
    popcal.document.body.innerHTML = buildcal();
    popcal.document.body.style.border="outset 2px";
    popcal.document.body.style.background=calbackground;
    popcal.document.body.style.color=caltextcolor;
  }
  popcal.show(document.body.clientWidth - 179, -148, 179, 148, document.body);
  watchpopup("popcal");
  return false;
}

calupdatetimer = null;

function movecal(nMths)
{
  Calendar.setMonth(Calendar.getMonth()+nMths);
  popcal.document.all["calhead"].innerHTML = buildcalheader();
  if (calupdatetimer == null)
    calupdatetimer = setTimeout("updatecal()", 0);
}

function updatecal()
{
  calupdatetimer = null;
  popcal.document.body.innerHTML = buildcal();
}

function opencal(d)
{
  if (defaultcal)
  {
    if (popcal)
      popcal.hide();
    eval(defaultcal + '(' + d + ')');
  }
}

function yhocal(dat)
{
  // adjust for the local time zone
  dat = dat - (new Date()).getTimezoneOffset() * 1000 * 60;

  // round down to closest day (in minutes)
  dat = Math.floor(dat / 60 / 60 / 24 / 1000) * 60 * 60 * 24;
  openNamedSearchWindow("http://calendar.yahoo.com/srt:0/?v=0&t=" + dat, "dqsdcal");
}

function msncal(dat)
{
  var dobj = new Date(dat);
  var yy = dobj.getYear();
  if (yy < 100) yy += 1900;
  openNamedSearchWindow("http://calendar.msn.com/calendar/isapi.dll?calendarView=day&day=" + dobj.getDate() + "&month=" + (dobj.getMonth()+1) + "&year=" + yy, "dqsdcal");
}

function nsccal(dat)
{
  var dobj = new Date(dat);
  var yy = dobj.getYear();
  if (yy < 100) yy += 1900;
  openNamedSearchWindow("http://calendar.netscape.com/cgi-bin/gx.cgi/AppLogic+DayGridView?_Date=" + (dobj.getMonth() + 1) + "/" + dobj.getDate() + "/" + yy, "dqsdcal");
}

function aolcal(dat)
{
  var dobj = new Date(dat);
  var yy = dobj.getYear();
  if (yy < 100) yy += 1900;
  openNamedSearchWindow("http://calendar.aol.com/cgi-bin/gx.cgi/AppLogic+DayGridView?_Date=" + (dobj.getMonth() + 1) + "/" + dobj.getDate() + "/" + yy, "dqsdcal");
}

function mycal(dat)
{
  var dobj = new Date(dat);
  var yy = dobj.getYear();
  if (yy < 100) yy += 1900;
  openNamedSearchWindow("http://www.mycalendar.com/?act=thisday&curdate=" + (dobj.getMonth() + 1) + "/" + dobj.getDate() + "/" + yy, "dqsdcal");
}


function evcal(dat)
{
  var dobj = new Date(dat);
  var yy = dobj.getYear();
  if (yy < 100) yy += 1900;
  openNamedSearchWindow("http://www.evite.com/welcome?date=" + (dobj.getMonth() + 1) + "%2F" + dobj.getDate() + "%2F" + yy, "dqsdcal");
}





function buildcalheader()
{
  return '<CENTER>' + getMonthName(Calendar.getMonth()+1)  + ' ' + Calendar.getFullYear() + '</CENTER>';
}


function buildcal()
{
  var year = Calendar.getFullYear();	    // Returns year in 4 digits
  var month = Calendar.getMonth();    // Returns month (0-11)

  var today = new Date();
  var weekday = -1;

  if (today.getMonth() == Calendar.getMonth() && today.getYear() == Calendar.getYear())
    weekday = today.getDay(); 

  var cal;    // Used for printing

  Calendar.setDate(1);    // Start the calendar day at '1'


  var TR_start = '<TR style=font:menu>';
  var TR_end = '</TR>';
  var day_start = '<TD width=14.2857% style="' + caldowstyle + '"><CENTER>';
  var day_end = '</CENTER></TD>';
  function today_start(d)
  {
    return '<TD style="cursor:default;background-color:' + caltodaybackground + ';' + caltodaystyle + '" ' +
           (defaultcal ? ' onmouseover=this.style.background="' + calhighbackground +
               '";this.style.color="' + calhightext +
               '"; onmouseout=this.style.background="' + caltodaybackground +
               '";this.style.color="' + caltodaytext +
               '" onmouseup=parent.opencal(' + d + ');' +
               'this.style.background="' + caltodaybackground +
               '";this.style.color="' + caltodaytext + '"' : '') +
           '><CENTER>';
  }
  var today_end   = '</CENTER></TD>';
  function gray_start(d)
  {
     return '<TD style="cursor:default;color:' + calgraytext + ';' + caldaystyle + '" ' +
           (defaultcal ? ' onmouseover=this.style.background="' + calhighbackground +
               '";this.style.color="' + calhightext +
               '"; onmouseout=this.style.background="' + calbackground +
               '";this.style.color="' + calgraytext +
               '" onmouseup=parent.opencal(' + d + ');'  +
               'this.style.background="' + calbackground +
               '";this.style.color="' + calgraytext + '"' : '') +
           '><CENTER>';
  }
  var gray_end   = '</CENTER></TD>';
  function TD_start(d)
  {
    return '<TD style="cursor:default;' + caldaystyle + '" ' +
           (defaultcal ? ' onmouseover=this.style.background="' + calhighbackground +
               '";this.style.color="' + calhightext +
               '"; onmouseout=this.style.background="' + calbackground +
               '";this.style.color="' + caltextcolor +
               '" onmouseup=parent.opencal(' + d + ');' +
               'this.style.background="' + calbackground +
               '";this.style.color="' + caltextcolor + '"' : '') +
           '><CENTER>';
  }
  var TD_end = '</CENTER></TD>';

  cal = '<TABLE WIDTH=100% HEIGHT=100% BORDER=0 CELLSPACING=0 CELLPADDING=0><TR style=font:menu>';
  cal += '<TD COLSPAN=7><TABLE WIDTH=100% HEIGHT=100% BORDER=0 CELLSPACING=0 CELLPADDING=0><TR style=font:menu>';
  cal += '<TD><TABLE ALIGN=LEFT HEIGHT=100% BORDER=0 CELLSPACING=0 CELLPADDING=0><TR style=font:menu>';
  cal += '<TD WIDTH=0 title="' + local(PREV_YEAR) +
         '" style="cursor:hand;' + calnavstyle +
         '" onmouseup="parent.movecal(-12);return false;" ' +
         'onmouseover=this.style.background="' + calhighbackground +
         '";this.style.color="' + calhightext +
         '" onmouseout=this.style.background="' + calbackground +
         '";this.style.color="' + caltextcolor +
         '"><CENTER>&nbsp;&lt;&nbsp;</CENTER></TD>';
  cal += '<TD WIDTH=0 title="' + local(PREV_MONTH) +
         '" style="cursor:hand;' + calnavstyle +
         '" onmouseup="parent.movecal(-1);" ' +
         'onmouseover=this.style.background="' + calhighbackground +
         '";this.style.color="' + calhightext +
         '" onmouseout=this.style.background="' + calbackground +
         '";this.style.color="' + caltextcolor +
         '"><CENTER>&nbsp;&lt;&nbsp;</CENTER></TD></TR></TABLE></TD>';
  if (weekday <0)
  {
    cal += '<TD ID=calhead title="' + local(GO_TO_TODAY) +
           '" style="cursor:hand;' + calmonthstyle +
           '" onmouseup="parent.Calendar=new Date();parent.movecal(0);" ' +
           'onmouseover=this.style.background="' + calhighbackground +
           '";this.style.color="' + calhightext +
           '" onmouseout=this.style.background="' + calbackground +
           '";this.style.color="' + caltextcolor +
           '"><CENTER>';
  }
  else
  {
    cal += '<TD ID=calhead COLSPAN="' + (DAYS_OF_WEEK - 2) +
           '" style="' + calmonthstyle + '">';
  }
  cal += buildcalheader();
  cal += '</TD>';
  cal += '<TD><TABLE ALIGN=RIGHT HEIGHT=100% BORDER=0 CELLSPACING=0 CELLPADDING=0><TR style=font:menu>';
  cal += '<TD WIDTH=0 title="' + local(NEXT_MONTH) +
         '" style="cursor:hand;' + calnavstyle +
         '" onmouseup="parent.movecal(+1);" ' +
         'onmouseover=this.style.background="' + calhighbackground +
         '";this.style.color="' + calhightext +
         '" onmouseout=this.style.background="' + calbackground +
         '";this.style.color="' + caltextcolor +
         '"><CENTER>&nbsp;&gt;&nbsp;</CENTER></TD>';
  cal += '<TD WIDTH=0 title="' + local(NEXT_YEAR) +
         '" style="cursor:hand;' + calnavstyle +
         '" onmouseup="parent.movecal(+12);" ' +
         'onmouseover=this.style.background="' + calhighbackground +
         '";this.style.color="' + calhightext +
         '" onmouseout=this.style.background="' + calbackground +
         '";this.style.color="' + caltextcolor +
         '"><CENTER>&nbsp;&gt;&nbsp;</CENTER></TD></TR></TABLE>';
  cal += '</TD></TR></TABLE>';
  cal += TR_end + TR_start;

  //printing day labels
  for(index=0; index < DAYS_OF_WEEK; index++)
  {
    cal += day_start;
    cal += getDayName(index+7+1);
    cal += day_end;
  }

  cal += TD_end;

  //fill spaces until first day in the month
  var whichmonth = -1;
  var filldays = Calendar.getDay();

  Calendar.setDate(Calendar.getDate() - filldays);

  //draw six weeks loop for each day in the month
  for (index=0; index < DAYS_OF_WEEK * 6; index++)
  {
    if (Calendar.getDate() == 1) whichmonth += 1;

    week_day = Calendar.getDay();

    // start new row if we hit a new week
    if (week_day == 0) cal += TR_end + TR_start;

    // highlight appropriately
    if (whichmonth != 0)
      cal += gray_start(Calendar.getTime()) + Calendar.getDate() + gray_end;
    else if (weekday >= 0 && today.getDate()==Calendar.getDate())
      cal += today_start(Calendar.getTime()) + Calendar.getDate() + today_end;
    else
      cal += TD_start(Calendar.getTime()) + Calendar.getDate() + TD_end;

    //advance the date for next iteration
    Calendar.setDate(Calendar.getDate()+1);

  }// end for loop

  cal += TR_end;

  //reset back the calendar's month
  Calendar.setMonth(Calendar.getMonth()-1);

  cal += '</TABLE>';

  //return the html string
  return cal;
}
</SCRIPT>

