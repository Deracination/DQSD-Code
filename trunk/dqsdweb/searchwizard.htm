<html>
<head>
<title>Dave's Quick Search Deskbar Search Wizard</title>
<link rel="stylesheet" type="text/css" href="dqsd.css">
<style>
li { padding-bottom: 1em }
img { margin: 5px }
.code { font-size: 80%; color: maroon; background: #eeeeee; border: black 1px solid; padding: 3px 3px }
</style>
<script language="Javascript1.2" src="utilities.js"></script>
</head>
<body>
<center>
<h2><nobr>Dave's Quick Search Deskbar <wbr><span style="color: navy">Search Wizard</span></nobr></h2>
<div class="lastupdate">
	<nobr>Last updated:
		<script>document.write( getDisplayDate( document.lastModified ) );</script>
	</nobr>
</div>
<br/>
[ <a href="doc.htm">Dave's Quick Search Deskbar</a> ]
</center>

<hr size="1">

<div align="center">
<b><a href="http://sourceforge.net/project/showfiles.php?group_id=42081&release_id=108860">Download version 0.6!</a></b><br/>released 4-Sep-2002<br/>
 (<a href="http://sourceforge.net/project/shownotes.php?release_id=108860">What's New</a>)</div>

<p>
One of biggest pains when writing a new DQSD search is massaging the correct HTML FORM into well-formed XML.&nbsp;&nbsp;I finally got annoyed enough to
write a little utility to do some of the work for me.&nbsp;&nbsp;I call it <b><a href="http://sourceforge.net/project/showfiles.php?group_id=42081&release_id=108860">Dave's Quick Search Deskbar Search Wizard</a></b>.
<center>
<img src="hatwand.jpg">
</center>
</p>

<hr size="1">

<h3>What does it do and why would I want to use it?</h3>

<p>
In a nutshell, it generates a DQSD search from the page currently displayed in your browser.
</p>

<p>
If you have no desire to ever write a search for DQSD, then don't read any further.&nbsp;&nbsp;If you do write searches from time to time, or at least want to, then you may find the wizard useful.
</p>

<p>
The first thing I typically do when creating a new search is to view the source for the page and strip out everything but the FORM for the search.&nbsp;&nbsp;This is tedious.&nbsp;&nbsp;And, often it's hard to find the right FORM when there are multiple FORMs in the page.&nbsp;&nbsp;Also, the process of converting the FORM's HTML to well-formed XML is error-prone (I always forget to close the INPUT elements with "/>").&nbsp;&nbsp;There had to be an easier way.
</p>

<h3>OK, so how do I use it?</h3>

<p>
<ol>
<li><a href="http://sourceforge.net/project/showfiles.php?group_id=42081&release_id=104770">Install</a> the Search Wizard.</li>&nbsp;&nbsp;You should see a new button on your toolbar:<br/>
<center>
<img src="wizard_toolbar.jpg">
</center>
If you don't, simply right-click on the IE toolbar, and click 'Customize...'.&nbsp;&nbsp;Add the button labeled "DQSD Search Wizard" in the list of available toolbar buttons.
<li>Go to the web page containing the search you want to add to DQSD.</li>
<li>Click in the field that contains the search string.</li>
<li>Start up the wizard by clicking on its Internet Explorer toolbar button.</li>
<li>
You should see a dialog that looks something like the following.&nbsp;&nbsp;Some of the fields will be automatically filled in.&nbsp;&nbsp;Enter a name and a title for the new search.&nbsp;&nbsp;The name is the string that will invoke the search and will be used for the file name, so keep it short and simple.<br/>
<center><img src="dqsdsearchwiz.jpg" align="top"></center>
</li>
<li>
In the list of FORM elements, make sure at least one FORM is checked.&nbsp;&nbsp;If you clicked in a field before invoking the wizard, the FORM containing that field should be already be checked.&nbsp;&nbsp;Selecting a FORM in the list will show the HTML content of the FORM in the area below the list.&nbsp;&nbsp;This is really just to provide some help in determining which FORM(s) you need.&nbsp;&nbsp;You can check multiple FORMs, all of which will be included in the search file.
</li>
<li>Hit OK and you'll be prompted to save the search file to your DQSD 'searches' directory.</li>
<li>After saving the file, it will come up in Notepad by default.&nbsp;&nbsp;(Click 'Options...' to change the editor to something other than Notepad.)
</ol>
</p>

<h3>Example</h3>

<p>
In the screen shot above, I went to <a href="http://www.msnbc.com">http://www.msnbc.com</a>, clicked in the search field...<br/>
<center><img src="msnbc.jpg"></center>
Then I clicked the 'DQSD Search Wizard' button.&nbsp;&nbsp;All the FORM elements in the page are listed, with the one checked that contains the 'active' element.&nbsp;&nbsp;I entered 'msnbc' for the name and 'MSNBC News' for the title (the title is what appears in the menu and help).&nbsp;&nbsp;Finally, I hit OK and I was prompted to save 'msnbc.xml' to the 'searches' subdirectory of my DQSD installation.
</p>

<p>
The resulting XML file search file will look something like <a href="#searchxml">the following</a>.&nbsp;&nbsp;And, in spite of the comment at the top of the file, this search just works.&nbsp;&nbsp;<i>Woo hoo!</i>&nbsp;&nbsp;(Well, I find it fairly exciting.)&nbsp;&nbsp;Granted, complicated searches won't 'just work', but the wizard will at least do a bunch of the tedious work for you.
</p>

<a name="searchxml" />
<div class="code">
<xmp>
<search function="msnbc">
  <COMMENT>

    Even though this XML search will probably load and is a healthy start
    toward a completed search, please be aware that this search will probably
    not work as is and will require some human tweaks.

  </COMMENT>
  <name>MSNBC</name>
  <category>News</category>
  <contributor>Glenn Carr</contributor>
  <link>http://www.msnbc.com/</link>
  <email>glenn at glenncarr dot com</email>
  <description>
  MSNBC Search
  </description>
  <form name="msnbcf"
        method="post"
        action="http//www.msnbc.com/modules/bom/findlog.asp">

    <COMMENT> The following field was active (i.e. had focus) when the search was generated. </COMMENT>

    <input type="hidden" name="qt" value="" />
  </form>
  <script><![CDATA[
    function msnbc(q)
    {
      if( nullArgs("msnbc", q) )
        return;

      // FORM variables for msnbcf

      // The wizard assigned the search string to this form field value because
      // this field was the active element when the search file was generated.
      // Change this to args.q if the search string is parsed with parseArgs.
      document.msnbcf.qt.value = q;

      submitForm(msnbcf);
    }
  ]]></script>
  <copyright>
    The following applies if this file is included and distributed with Dave's Quick Search Deskbar:
    Copyright (c) 2002 David Bau; Distributed under the terms of the GNU Public License, Version 2 (http://www.gnu.org/copyleft/gpl.txt)
  </copyright>
  <created_by>
    This search file was initially created by on 09/04/02 at 10:13:03
    Dave's Quick Search Deskbar Search Wizard version 0.6 (beta),
    Copyright (c) 2002 Glenn Carr; Distributed under the terms of the GNU General Public License, Version 2
  </created_by>
</search>
</xmp>
</div>

<h3>Switches</h3>

<p>
The 'parseArgs' utility method has become the convention for parsing switches for searches.&nbsp;&nbsp;If you enter some switches in the 'Switches:' field of the search wizard...<br/>
<center><img src="switches.jpg"></center><br/>
...the generated search will now include basic code for parsing the switches:
</p>

<div class="code">
<xmp>
<search function="msnbc">
  <COMMENT>

    Even though this XML search will probably load and is a healthy start
    toward a completed search, please be aware that this search will probably
    not work as is and will require some human tweaks.

  </COMMENT>
  <name>MSNBC</name>
  <category>News</category>
  <contributor>Glenn Carr</contributor>
  <link>http://www.msnbc.com/</link>
  <email>glenn at glenncarr dot com</email>
  <description>
  MSNBC Search
  </description>
  <form name="msnbcf"
        method="post"
        action="http//www.msnbc.com/modules/bom/findlog.asp">

    <COMMENT> The following field was active (i.e. had focus) when the search was generated. </COMMENT>

    <input type="hidden" name="qt" value="" />
  </form>
  <script><![CDATA[
    function msnbc(q)
    {
      if( nullArgs("msnbc", q) )
        return;
</xmp><xmp style="color: red">
      // Parse switches with parseArgs:

      // parseArgs usage:
      // Arguments:
      //    q                - string from the search function
      //    expectedSwitches - list or array of the expected switch values
      //    expandSwitches   - optional parameter [default = true] used to determine
      //                       if the switch shortcuts should be expanded (i.e. /f becomes /foo)
      // Returns an object with these properties:
      //    q        - the input string with the switches removed
      //    switches - array of objects with these two properties:
      //                  name:   expanded name of the matched switch (i.e. foo as in /foo:bar)
      //                  value:  value of switch (i.e. bar as in /foo:bar)
      //    switch_val - associative array with the switch name as the key with the switch value
      //                 as the value. (i.e. switch_val["foo"] = "bar" as in /foo:bar)

      //var args = parseArgs(q, "news, sports, business");
      //if ( args.switches.length > 0 )
      //{
      //  switch( args.switches[0].name )
      //  {
      //    case "news":
      //         break;
      //    case "sports":
      //         break;
      //    case "business":
      //         break;
      //    default:
      //         break;
      //  } //end-switch
      //}
</xmp><xmp>
      // FORM variables for msnbcf

      // The wizard assigned the search string to this form field value because
      // this field was the active element when the search file was generated.
      // Change this to args.q if the search string is parsed with parseArgs.
      document.msnbcf.qt.value = q;

      submitForm(msnbcf);
    }
  ]]></script>
  <copyright>
    The following applies if this file is included and distributed with Dave's Quick Search Deskbar:
    Copyright (c) 2002 David Bau; Distributed under the terms of the GNU Public License, Version 2 (http://www.gnu.org/copyleft/gpl.txt)
  </copyright>
  <created_by>
    This search file was initially created by on 09/04/02 at 10:14:22
    Dave's Quick Search Deskbar Search Wizard version 0.6 (beta),
    Copyright (c) 2002 Glenn Carr; Distributed under the terms of the GNU General Public License, Version 2
  </created_by>
</search>
</xmp>
</div>

<p>
Anyway, that's the gist of it.&nbsp;&nbsp;It still needs a lot of testing, and there is plenty of room for improvement.&nbsp;&nbsp;It's also <a href="http://cvs.sourceforge.net/cgi-bin/viewcvs.cgi/dqsd/dqsd/src/DQSDSearchWiz/">open source</a> like DQSD, so feel free to hack away and send in bug fixes.
<p>

<script>
document.write( buildEmail( 'glenn', 'glenncarr', 'com', 'Glenn Carr' ) );
</script>
<br/>
August 20, 2002

<h3>To do:</h3>
Feel free to grab the source and make the following improvements.&nbsp;&nbsp;These are not in any particular order.
<ul>
<li>
Add some context-sensitive help.&nbsp;&nbsp;The little help button is there, but it does nothing.
</li>
<li>
Run this thing through BoundsChecker or Purify.&nbsp;&nbsp;I hacked this together so quickly, I know there are probably some BSTRs not being freed.
</li>
<li>
Display the HTML content of each form in a browser control, instead of as just plain text.&nbsp;&nbsp;Not really sure if this would work without the entire page, but it would be more useful if it did.
</li>
<li>
Add a 'DQSD Search Wizard' menu item to the IE context and tools menus.
</li>
</ul>

<h3>Credits</h3>
<ul>
<li>
<a href="http://notesbydave.com">David Bau</a> for such a cool tool.&nbsp;&nbsp;Aren't the best things in life usually the simplest?
</li>
<li>
<a href="http://www.cheztabor.com/projects.htm">Tim Tabor</a> for sharing his code.&nbsp;&nbsp;Probably couldn't (and for sure wouldn't) have done it without those examples.
</li>
</ul>


</body>
</html>
